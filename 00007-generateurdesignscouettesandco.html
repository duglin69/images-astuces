<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>G√©n√©rateur de designs publitaires</title>
    <link href="https://fonts.googleapis.com/css2?family=Space+Mono:wght@400;700&family=Crimson+Pro:wght@300;600&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --bg-dark: #0a0e27;
            --bg-card: #1a1f3a;
            --accent: #ff6b9d;
            --accent-secondary: #4ecdc4;
            --text-primary: #e8eaf6;
            --text-secondary: #9fa8da;
            --border: #2a3f5f;
            --success: #4caf50;
            --warning: #ff9800;
        }

        body {
            font-family: 'Crimson Pro', serif;
            background: var(--bg-dark);
            color: var(--text-primary);
            line-height: 1.6;
            padding: 2rem;
            background-image: 
                radial-gradient(circle at 20% 50%, rgba(255, 107, 157, 0.08) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(78, 205, 196, 0.08) 0%, transparent 50%);
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 3rem;
            animation: fadeInDown 0.8s ease;
        }

        h1 {
            font-family: 'Space Mono', monospace;
            font-size: clamp(2rem, 5vw, 3.5rem);
            font-weight: 700;
            background: linear-gradient(135deg, var(--accent), var(--accent-secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 0.5rem;
            letter-spacing: -0.02em;
        }

        .subtitle {
            font-size: 1.2rem;
            color: var(--text-secondary);
            font-weight: 300;
        }

        .version-badge {
            display: inline-block;
            background: linear-gradient(135deg, var(--accent), var(--accent-secondary));
            color: white;
            padding: 0.3rem 0.8rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-family: 'Space Mono', monospace;
            margin-top: 0.5rem;
        }

        /* Barre d'outils sup√©rieure */
        .toolbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 1rem;
            margin-bottom: 2rem;
            padding: 1rem;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 12px;
            flex-wrap: wrap;
        }

        .toolbar-section {
            display: flex;
            gap: 0.5rem;
            align-items: center;
        }

        .mode-switch {
            display: flex;
            background: var(--bg-dark);
            border-radius: 8px;
            overflow: hidden;
        }

        .mode-btn {
            padding: 0.6rem 1.2rem;
            background: transparent;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            font-family: 'Space Mono', monospace;
            font-size: 0.85rem;
            transition: all 0.3s ease;
        }

        .mode-btn.active {
            background: linear-gradient(135deg, var(--accent), var(--accent-secondary));
            color: white;
        }

        .language-toggle {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 1rem;
        }

        .language-toggle label {
            font-family: 'Space Mono', monospace;
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .toggle-switch {
            position: relative;
            width: 60px;
            height: 30px;
            background: var(--bg-dark);
            border: 2px solid var(--border);
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .toggle-switch:hover {
            border-color: var(--accent);
        }

        .toggle-slider {
            position: absolute;
            top: 3px;
            left: 3px;
            width: 20px;
            height: 20px;
            background: linear-gradient(135deg, var(--accent), var(--accent-secondary));
            border-radius: 50%;
            transition: transform 0.3s ease;
        }

        #languageToggle:checked + .toggle-switch .toggle-slider {
            transform: translateX(30px);
        }

        #languageToggle {
            display: none;
        }

        .action-btn {
            padding: 0.6rem 1.2rem;
            background: var(--bg-dark);
            border: 1px solid var(--border);
            border-radius: 8px;
            color: var(--text-primary);
            cursor: pointer;
            font-family: 'Space Mono', monospace;
            font-size: 0.85rem;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .action-btn:hover {
            border-color: var(--accent);
            transform: translateY(-2px);
        }

        .action-btn.primary {
            background: linear-gradient(135deg, var(--accent), var(--accent-secondary));
            border: none;
            color: white;
        }

        /* Sidebar pour historique et exemples */
        .main-layout {
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: 2rem;
        }

        .sidebar {
            position: sticky;
            top: 2rem;
            height: fit-content;
            max-height: calc(100vh - 4rem);
            overflow-y: auto;
        }

        .sidebar-section {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .sidebar-section h3 {
            font-family: 'Space Mono', monospace;
            font-size: 0.9rem;
            color: var(--accent);
            margin-bottom: 1rem;
            text-transform: uppercase;
        }

        .history-item, .example-item {
            padding: 0.8rem;
            background: var(--bg-dark);
            border: 1px solid var(--border);
            border-radius: 8px;
            margin-bottom: 0.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.85rem;
        }

        .history-item:hover, .example-item:hover {
            border-color: var(--accent);
            transform: translateX(5px);
        }

        .history-item .timestamp {
            font-size: 0.75rem;
            color: var(--text-secondary);
            margin-top: 0.3rem;
        }

        .example-item .example-preview {
            width: 100%;
            height: 80px;
            background: var(--bg-dark);
            border-radius: 6px;
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
        }

        /* Main content */
        .main-content {
            min-width: 0;
        }

        .generator-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 2rem;
            margin-bottom: 2rem;
        }

        .section {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 1.5rem;
            animation: fadeInUp 0.8s ease;
            animation-fill-mode: both;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            position: relative;
        }

        .section:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(255, 107, 157, 0.15);
        }

        .section.collapsed .section-content {
            display: none;
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            user-select: none;
        }

        .section h2 {
            font-family: 'Space Mono', monospace;
            font-size: 1.1rem;
            color: var(--accent);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .collapse-icon {
            color: var(--text-secondary);
            transition: transform 0.3s ease;
        }

        .section.collapsed .collapse-icon {
            transform: rotate(-90deg);
        }

        .section-content {
            margin-top: 1rem;
        }

        .product-preview {
            width: 60px;
            height: 60px;
            background: var(--bg-dark);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            margin: 1rem auto;
            transition: transform 0.3s ease;
        }

        .product-preview:hover {
            transform: scale(1.1);
        }

        .suggestions-box {
            background: rgba(78, 205, 196, 0.1);
            border: 1px dashed var(--accent-secondary);
            border-radius: 8px;
            padding: 1rem;
            margin-top: 1rem;
        }

        .suggestions-box h4 {
            font-family: 'Space Mono', monospace;
            font-size: 0.85rem;
            color: var(--accent-secondary);
            margin-bottom: 0.5rem;
        }

        .suggestion-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .suggestion-tag {
            padding: 0.4rem 0.8rem;
            background: var(--bg-dark);
            border: 1px solid var(--accent-secondary);
            border-radius: 20px;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .suggestion-tag:hover {
            background: var(--accent-secondary);
            color: var(--bg-dark);
            transform: translateY(-2px);
        }

        .compatibility-warning {
            background: rgba(255, 152, 0, 0.1);
            border-left: 3px solid var(--warning);
            padding: 0.8rem;
            margin-top: 1rem;
            border-radius: 4px;
            font-size: 0.85rem;
            display: none;
        }

        .compatibility-warning.show {
            display: block;
            animation: slideIn 0.3s ease;
        }

        label {
            display: block;
            margin-bottom: 0.5rem;
            color: var(--text-secondary);
            font-size: 0.95rem;
        }

        select, input, textarea {
            width: 100%;
            padding: 0.8rem;
            background: var(--bg-dark);
            border: 1px solid var(--border);
            border-radius: 8px;
            color: var(--text-primary);
            font-family: 'Crimson Pro', serif;
            font-size: 1rem;
            transition: border-color 0.3s ease, box-shadow 0.3s ease;
        }

        select:focus, input:focus, textarea:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 3px rgba(255, 107, 157, 0.1);
        }

        textarea {
            min-height: 100px;
            resize: vertical;
        }

        .conditional-field {
            margin-top: 1rem;
            padding: 1rem;
            background: rgba(255, 107, 157, 0.05);
            border: 1px dashed var(--accent);
            border-radius: 8px;
            animation: slideDown 0.3s ease;
        }

        .hidden {
            display: none !important;
        }

        .character-inputs {
            display: grid;
            gap: 1rem;
            margin-top: 1rem;
        }

        .character-input {
            padding: 1rem;
            background: rgba(78, 205, 196, 0.05);
            border: 1px solid var(--accent-secondary);
            border-radius: 8px;
        }

        .character-input h3 {
            font-family: 'Space Mono', monospace;
            font-size: 0.9rem;
            color: var(--accent-secondary);
            margin-bottom: 0.5rem;
        }

        .button-group {
            display: flex;
            gap: 1rem;
            margin-top: 2rem;
        }

        .generate-btn {
            flex: 1;
            padding: 1.2rem;
            background: linear-gradient(135deg, var(--accent), var(--accent-secondary));
            color: white;
            border: none;
            border-radius: 12px;
            font-family: 'Space Mono', monospace;
            font-size: 1.1rem;
            font-weight: 700;
            cursor: pointer;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .generate-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(255, 107, 157, 0.3);
        }

        .generate-btn:active {
            transform: translateY(0);
        }

        .generate-btn.secondary {
            background: var(--bg-card);
            border: 2px solid var(--accent);
            color: var(--accent);
        }

        .output-section {
            margin-top: 3rem;
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.5s ease, transform 0.5s ease;
        }

        .output-section.active {
            opacity: 1;
            transform: translateY(0);
        }

        .prompt-box {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .prompt-box h3 {
            font-family: 'Space Mono', monospace;
            font-size: 1.2rem;
            margin-bottom: 1rem;
            color: var(--accent);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .variations-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }

        .variation-box {
            background: var(--bg-dark);
            padding: 1rem;
            border-radius: 8px;
            border: 1px solid var(--border);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .variation-box:hover {
            border-color: var(--accent-secondary);
            transform: translateY(-2px);
        }

        .variation-box.selected {
            border-color: var(--accent);
            box-shadow: 0 0 0 2px rgba(255, 107, 157, 0.2);
        }

        .variation-label {
            font-family: 'Space Mono', monospace;
            font-size: 0.8rem;
            color: var(--accent-secondary);
            margin-bottom: 0.5rem;
        }

        .prompt-content {
            background: var(--bg-dark);
            padding: 1.5rem;
            border-radius: 8px;
            border: 1px solid var(--border);
            font-family: 'Crimson Pro', serif;
            line-height: 1.8;
            margin-bottom: 1rem;
            white-space: pre-wrap;
            word-break: break-word;
        }

        .action-buttons {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }

        .copy-btn, .export-btn, .save-btn {
            padding: 0.8rem 1.5rem;
            background: var(--accent);
            color: white;
            border: none;
            border-radius: 8px;
            font-family: 'Space Mono', monospace;
            font-size: 0.9rem;
            cursor: pointer;
            transition: background 0.3s ease, transform 0.2s ease;
        }

        .copy-btn:hover, .export-btn:hover, .save-btn:hover {
            background: var(--accent-secondary);
            transform: translateY(-1px);
        }

        .export-btn {
            background: var(--accent-secondary);
        }

        .save-btn {
            background: var(--success);
        }

        .info-note {
            background: rgba(78, 205, 196, 0.1);
            border-left: 3px solid var(--accent-secondary);
            padding: 0.8rem;
            margin-top: 0.5rem;
            border-radius: 4px;
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(10, 14, 39, 0.9);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal.show {
            display: flex;
        }

        .modal-content {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 2rem;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .modal-header h3 {
            font-family: 'Space Mono', monospace;
            color: var(--accent);
        }

        .close-modal {
            background: none;
            border: none;
            color: var(--text-secondary);
            font-size: 1.5rem;
            cursor: pointer;
            transition: color 0.3s ease;
        }

        .close-modal:hover {
            color: var(--accent);
        }

        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                max-height: 0;
            }
            to {
                opacity: 1;
                max-height: 1000px;
            }
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(-10px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        /* Mode expert - affichage compact */
        .expert-mode .section {
            padding: 1rem;
        }

        .expert-mode .section h2 {
            font-size: 0.95rem;
        }

        .expert-mode .conditional-field {
            padding: 0.8rem;
        }

        /* Responsive */
        @media (max-width: 1200px) {
            .main-layout {
                grid-template-columns: 1fr;
            }

            .sidebar {
                position: relative;
                top: 0;
                max-height: none;
            }
        }

        @media (max-width: 768px) {
            body {
                padding: 1rem;
            }

            .generator-grid {
                grid-template-columns: 1fr;
                gap: 1.5rem;
            }

            h1 {
                font-size: 2rem;
            }

            .toolbar {
                flex-direction: column;
                align-items: stretch;
            }

            .toolbar-section {
                justify-content: center;
            }

            .button-group {
                flex-direction: column;
            }
        }

        .section:nth-child(1) { animation-delay: 0.1s; }
        .section:nth-child(2) { animation-delay: 0.2s; }
        .section:nth-child(3) { animation-delay: 0.3s; }
        .section:nth-child(4) { animation-delay: 0.4s; }
        .section:nth-child(5) { animation-delay: 0.5s; }
        .section:nth-child(6) { animation-delay: 0.6s; }
        .section:nth-child(7) { animation-delay: 0.7s; }
        .section:nth-child(8) { animation-delay: 0.8s; }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üé® G√©n√©rateur de Prompts Pro</h1>
            <p class="subtitle">Cr√©ez des visuels personnalis√©s pour tous vos supports</p>
            <span class="version-badge">v4.0 - Edition Compl√®te</span>
        </header>

        <!-- Barre d'outils -->
        <div class="toolbar">
            <div class="toolbar-section">
                <div class="mode-switch">
                    <button class="mode-btn active" onclick="switchMode('guided')">üéØ Mode Guid√©</button>
                    <button class="mode-btn" onclick="switchMode('expert')">‚ö° Mode Expert</button>
                </div>
            </div>

            <div class="toolbar-section language-toggle">
                <label for="languageToggle">Fran√ßais</label>
                <input type="checkbox" id="languageToggle" onchange="updateLanguage()">
                <label for="languageToggle" class="toggle-switch">
                    <span class="toggle-slider"></span>
                </label>
                <label for="languageToggle">English</label>
            </div>

            <div class="toolbar-section">
                <button class="action-btn" onclick="openHistoryModal()">üìö Historique</button>
                <button class="action-btn primary" onclick="surpriseMe()">‚ú® Surprends-moi !</button>
            </div>
        </div>

        <!-- Layout principal -->
        <div class="main-layout">
            <!-- Sidebar -->
            <aside class="sidebar">
                <!-- Historique r√©cent -->
                <div class="sidebar-section">
                    <h3>üìå R√©cents</h3>
                    <div id="recentHistory"></div>
                </div>

                <!-- Exemples d'inspiration -->
                <div class="sidebar-section">
                    <h3>üí° Exemples</h3>
                    <div id="examplesLibrary"></div>
                </div>

                <!-- Tags / Cat√©gories -->
                <div class="sidebar-section">
                    <h3>üè∑Ô∏è Cat√©gories</h3>
                    <div class="suggestion-tags">
                        <span class="suggestion-tag" onclick="filterByTag('anniversaire')">üéÇ Anniversaire</span>
                        <span class="suggestion-tag" onclick="filterByTag('entreprise')">üíº Entreprise</span>
                        <span class="suggestion-tag" onclick="filterByTag('humour')">üòÑ Humour</span>
                        <span class="suggestion-tag" onclick="filterByTag('sport')">‚öΩ Sport</span>
                        <span class="suggestion-tag" onclick="filterByTag('famille')">üë®‚Äçüë©‚Äçüëß Famille</span>
                    </div>
                </div>
            </aside>

            <!-- Contenu principal -->
            <main class="main-content">
                <div class="generator-grid" id="generatorGrid">
                    <!-- Section 1: Type de produit -->
                    <div class="section" data-section="product">
                        <div class="section-header" onclick="toggleSection(this)">
                            <h2>üì¶ Type de produit</h2>
                            <span class="collapse-icon">‚ñº</span>
                        </div>
                        <div class="section-content">
                            <label for="productType">Sur quel support souhaitez-vous imprimer ?</label>
                            <select id="productType" onchange="onProductChange()">
                                <option value="">-- S√©lectionnez --</option>
                                <option value="tshirt">T-shirt</option>
                                <option value="sweatshirt">Sweatshirt</option>
                                <option value="hoodie">Hoodie</option>
                                <option value="polo">Polo</option>
                                <option value="tank">D√©bardeur</option>
                                <option value="jacket">Veste</option>
                                <option value="cap">Casquette</option>
                                <option value="beanie">Bonnet</option>
                                <option value="tote">Tote bag</option>
                                <option value="backpack">Sac √† dos</option>
                                <option value="poster">Poster</option>
                                <option value="canvas">Toile</option>
                                <option value="frame">Cadre photo</option>
                                <option value="sticker">Sticker</option>
                                <option value="mug">Mug</option>
                                <option value="waterbottle">Gourde</option>
                                <option value="phonecase">Coque de t√©l√©phone</option>
                                <option value="mousepad">Tapis de souris</option>
                                <option value="pillow">Coussin</option>
                                <option value="blanket">Couverture</option>
                                <option value="towel">Serviette de bain</option>
                                <option value="napkin">Serviette de table</option>
                                <option value="apron">Tablier</option>
                                <option value="magnet">Magnet</option>
                                <option value="coaster">Dessous de verre</option>
                                <option value="puzzle">Puzzle</option>
                                <option value="calendar">Calendrier</option>
                                <option value="notebook">Carnet</option>
                                <option value="pingpong">Raquette de ping-pong</option>
                                <option value="football">Ballon de football</option>
                                <option value="basketball">Ballon de basket</option>
                                <option value="tennis">Balle de tennis</option>
                                <option value="frisbee">Frisbee</option>
                                <option value="skateboard">Skateboard</option>
                                <option value="canette">Canette (soda)</option>
                                <option value="beerlabel">√âtiquette de bi√®re/alcool</option>
                                <option value="custom">üåü Autre objet (√† pr√©ciser)</option>
                            </select>

                            <div id="productPreview" class="product-preview"></div>
                            
                            <div id="customProductField" class="conditional-field hidden">
                                <label for="customProduct">D√©crivez l'objet que vous souhaitez customiser :</label>
                                <input type="text" id="customProduct" placeholder="Ex: coussin, agenda, gourde isotherme...">
                                <p class="info-note">üí° Nous √©tudierons la faisabilit√© de votre projet et vous contacterons !</p>
                            </div>

                            <!-- Suggestions intelligentes -->
                            <div id="productSuggestions" class="suggestions-box hidden">
                                <h4>‚ú® Styles populaires pour ce produit :</h4>
                                <div class="suggestion-tags" id="styleSuggestions"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Section 2: Format et orientation -->
                    <div class="section" data-section="format">
                        <div class="section-header" onclick="toggleSection(this)">
                            <h2>üìê Format</h2>
                            <span class="collapse-icon">‚ñº</span>
                        </div>
                        <div class="section-content">
                            <label for="format">Orientation du design</label>
                            <select id="format" onchange="checkCompatibility()">
                                <option value="">-- S√©lectionnez --</option>
                                <option value="square">Carr√© (1:1)</option>
                                <option value="portrait">Portrait (vertical)</option>
                                <option value="landscape">Paysage (horizontal)</option>
                                <option value="circle">Circulaire</option>
                                <option value="custom">Format personnalis√©</option>
                            </select>
                        </div>
                    </div>

                    <!-- Section 3: Mode de cr√©ation -->
                    <div class="section" data-section="creation">
                        <div class="section-header" onclick="toggleSection(this)">
                            <h2>üé≠ Mode de cr√©ation</h2>
                            <span class="collapse-icon">‚ñº</span>
                        </div>
                        <div class="section-content">
                            <label for="creationMode">Type de design</label>
                            <select id="creationMode" onchange="toggleParodyField()">
                                <option value="original">Design original</option>
                                <option value="parody">Parodie de r√©f√©rence culturelle</option>
                            </select>

                            <div id="parodyFields" class="conditional-field hidden">
                                <label for="parodyReference">R√©f√©rence √† parodier</label>
                                <select id="parodyReference" onchange="toggleCustomParody()">
                                    <option value="">-- S√©lectionnez --</option>
                                    <option value="star wars">Star Wars</option>
                                    <option value="harry potter">Harry Potter</option>
                                    <option value="marvel">Marvel</option>
                                    <option value="disney">Disney</option>
                                    <option value="game of thrones">Game of Thrones</option>
                                    <option value="lord of the rings">Le Seigneur des Anneaux</option>
                                    <option value="stranger things">Stranger Things</option>
                                    <option value="pokemon">Pok√©mon</option>
                                    <option value="breaking bad">Breaking Bad</option>
                                    <option value="friends">Friends</option>
                                    <option value="custom">Autre (√† pr√©ciser)</option>
                                </select>

                                <div id="customParodyField" class="conditional-field hidden">
                                    <label for="customParody">Pr√©cisez la r√©f√©rence</label>
                                    <input type="text" id="customParody" placeholder="Ex: The Office, Matrix, etc.">
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Section 4: Style esth√©tique -->
                    <div class="section" data-section="aesthetic">
                        <div class="section-header" onclick="toggleSection(this)">
                            <h2>üé® Style esth√©tique</h2>
                            <span class="collapse-icon">‚ñº</span>
                        </div>
                        <div class="section-content">
                            <label for="aesthetic">Esth√©tique visuelle</label>
                            <select id="aesthetic" onchange="onAestheticChange()">
                                <option value="">-- S√©lectionnez --</option>
                                <option value="minimalist">Minimaliste</option>
                                <option value="vintage">Vintage / R√©tro</option>
                                <option value="modern">Moderne</option>
                                <option value="grunge">Grunge</option>
                                <option value="cartoon">Cartoon / BD</option>
                                <option value="realistic">R√©aliste</option>
                                <option value="abstract">Abstrait</option>
                                <option value="pop art">Pop Art</option>
                                <option value="watercolor">Aquarelle</option>
                                <option value="neon">N√©on</option>
                                <option value="gothic">Gothique</option>
                                <option value="cyberpunk">Cyberpunk</option>
                                <option value="steampunk">Steampunk</option>
                                <option value="kawaii">Kawaii</option>
                                <option value="custom">Autre (√† pr√©ciser)</option>
                            </select>

                            <div id="customAestheticField" class="conditional-field hidden">
                                <label for="customAesthetic">Pr√©cisez le style</label>
                                <input type="text" id="customAesthetic" placeholder="Ex: art d√©co, bauhaus, vaporwave...">
                            </div>

                            <!-- Alerte de compatibilit√© -->
                            <div id="compatibilityWarning" class="compatibility-warning">
                                ‚ö†Ô∏è <span id="warningText"></span>
                            </div>
                        </div>
                    </div>

                    <!-- Section 5: Personnages -->
                    <div class="section" data-section="characters">
                        <div class="section-header" onclick="toggleSection(this)">
                            <h2>üë• Personnages</h2>
                            <span class="collapse-icon">‚ñº</span>
                        </div>
                        <div class="section-content">
                            <label for="characterCount">Nombre de personnages</label>
                            <select id="characterCount" onchange="updateCharacterInputs()">
                                <option value="0">Aucun personnage</option>
                                <option value="1">1 personnage</option>
                                <option value="2">2 personnages</option>
                                <option value="3">3 personnages</option>
                                <option value="4">4 personnages</option>
                                <option value="5">5 personnages ou plus</option>
                            </select>

                            <div id="characterInputs" class="character-inputs"></div>

                            <div id="characterInteractionField" class="conditional-field hidden">
                                <label for="characterInteraction">Interaction entre les personnages (optionnel)</label>
                                <textarea id="characterInteraction" placeholder="Ex: se serrant la main, se battant en duel, dansant ensemble, jouant au poker..."></textarea>
                                <p class="info-note">üí° D√©crivez comment les personnages interagissent ou se positionnent les uns par rapport aux autres.</p>
                            </div>
                        </div>
                    </div>

                    <!-- Section 6: Texte -->
                    <div class="section" data-section="text">
                        <div class="section-header" onclick="toggleSection(this)">
                            <h2>‚úçÔ∏è Texte</h2>
                            <span class="collapse-icon">‚ñº</span>
                        </div>
                        <div class="section-content">
                            <label for="titleText">Titre principal (optionnel)</label>
                            <input type="text" id="titleText" placeholder='Ex: "BEST DAD EVER"'>

                            <div style="margin-top: 1rem;">
                                <label for="textFont">Police de caract√®res</label>
                                <select id="textFont" onchange="toggleCustomFont()">
                                    <option value="">-- Par d√©faut --</option>
                                    <option value="bold sans-serif">Gras sans-serif</option>
                                    <option value="elegant serif">Serif √©l√©gant</option>
                                    <option value="handwritten script">Script manuscrit</option>
                                    <option value="modern geometric">G√©om√©trique moderne</option>
                                    <option value="retro vintage">R√©tro vintage</option>
                                    <option value="graffiti street art">Graffiti / Street art</option>
                                    <option value="stencil military">Pochoir / Militaire</option>
                                    <option value="cartoon comic">Cartoon / Comic</option>
                                    <option value="futuristic tech">Futuriste / Tech</option>
                                    <option value="custom">Autre (√† pr√©ciser)</option>
                                </select>
                            </div>

                            <div id="customFontField" class="conditional-field hidden">
                                <label for="customFont">Pr√©cisez la police</label>
                                <input type="text" id="customFont" placeholder="Ex: brushed, gothic, neon...">
                            </div>

                            <div style="margin-top: 1rem;">
                                <label for="textColor">Couleur du texte</label>
                                <select id="textColor" onchange="toggleCustomTextColor()">
                                    <option value="">-- Par d√©faut --</option>
                                    <option value="white">Blanc</option>
                                    <option value="black">Noir</option>
                                    <option value="red">Rouge</option>
                                    <option value="blue">Bleu</option>
                                    <option value="yellow">Jaune</option>
                                    <option value="green">Vert</option>
                                    <option value="gold">Or</option>
                                    <option value="silver">Argent</option>
                                    <option value="gradient rainbow">D√©grad√© arc-en-ciel</option>
                                    <option value="custom">Autre (√† pr√©ciser)</option>
                                </select>
                            </div>

                            <div id="customTextColorField" class="conditional-field hidden">
                                <label for="customTextColor">Pr√©cisez la couleur</label>
                                <input type="text" id="customTextColor" placeholder="Ex: violet pastel, orange vif...">
                            </div>

                            <div style="margin-top: 1rem;">
                                <label for="subtitleText">Sous-titre (optionnel)</label>
                                <input type="text" id="subtitleText" placeholder="Ex: 2024">
                            </div>

                            <div style="margin-top: 1rem;">
                                <label for="additionalText">Texte additionnel (optionnel)</label>
                                <textarea id="additionalText" placeholder="Autre texte √† inclure..."></textarea>
                            </div>
                        </div>
                    </div>

                    <!-- Section 7: Logo -->
                    <div class="section" data-section="logo">
                        <div class="section-header" onclick="toggleSection(this)">
                            <h2>üè∑Ô∏è Logo / Embl√®me</h2>
                            <span class="collapse-icon">‚ñº</span>
                        </div>
                        <div class="section-content">
                            <label for="includeLogo">Inclure un logo ?</label>
                            <select id="includeLogo" onchange="toggleLogoFields()">
                                <option value="no">Non</option>
                                <option value="yes">Oui</option>
                            </select>

                            <div id="logoFields" class="conditional-field hidden">
                                <label for="logoDescription">Description du logo</label>
                                <textarea id="logoDescription" placeholder="Ex: couronne dor√©e, √©toile stylis√©e, blason m√©di√©val..."></textarea>

                                <div style="margin-top: 1rem;">
                                    <label for="logoPosition">Position du logo</label>
                                    <select id="logoPosition">
                                        <option value="top">En haut</option>
                                        <option value="bottom">En bas</option>
                                        <option value="left">√Ä gauche</option>
                                        <option value="right">√Ä droite</option>
                                        <option value="center">Au centre</option>
                                        <option value="corner">Dans un coin</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Section 8: Ambiance et couleurs -->
                    <div class="section" data-section="mood">
                        <div class="section-header" onclick="toggleSection(this)">
                            <h2>üåà Ambiance & Couleurs</h2>
                            <span class="collapse-icon">‚ñº</span>
                        </div>
                        <div class="section-content">
                            <label for="mood">Ambiance g√©n√©rale</label>
                            <select id="mood" onchange="toggleCustomMood()">
                                <option value="">-- S√©lectionnez --</option>
                                <option value="joyful energetic">Joyeuse et √©nergique</option>
                                <option value="calm peaceful">Calme et paisible</option>
                                <option value="dramatic epic">Dramatique et √©pique</option>
                                <option value="mysterious dark">Myst√©rieuse et sombre</option>
                                <option value="playful fun">Ludique et amusante</option>
                                <option value="elegant sophisticated">√âl√©gante et sophistiqu√©e</option>
                                <option value="romantic dreamy">Romantique et r√™veuse</option>
                                <option value="aggressive powerful">Agressive et puissante</option>
                                <option value="nostalgic melancholic">Nostalgique et m√©lancolique</option>
                                <option value="custom">Autre (√† pr√©ciser)</option>
                            </select>

                            <div id="customMoodField" class="conditional-field hidden">
                                <label for="customMood">Pr√©cisez l'ambiance</label>
                                <input type="text" id="customMood" placeholder="Ex: surr√©aliste, dystopique...">
                            </div>

                            <div style="margin-top: 1rem;">
                                <label for="colors">Palette de couleurs</label>
                                <select id="colors" onchange="onColorChange()">
                                    <option value="">-- S√©lectionnez --</option>
                                    <option value="monochrome black and white">Monochrome noir et blanc</option>
                                    <option value="vibrant rainbow">Arc-en-ciel vibrant</option>
                                    <option value="pastel soft">Pastel doux</option>
                                    <option value="neon bright">N√©on √©clatant</option>
                                    <option value="earth tones warm">Tons terreux chauds</option>
                                    <option value="cool blues and purples">Bleus et violets froids</option>
                                    <option value="sunset orange and pink">Coucher de soleil (orange et rose)</option>
                                    <option value="forest green and brown">For√™t (vert et marron)</option>
                                    <option value="ocean teal and blue">Oc√©an (turquoise et bleu)</option>
                                    <option value="custom">Autre (√† pr√©ciser)</option>
                                </select>
                            </div>

                            <div id="customColorsField" class="conditional-field hidden">
                                <label for="customColors">Pr√©cisez les couleurs</label>
                                <input type="text" id="customColors" placeholder="Ex: or et noir, rouge bordeaux et cr√®me...">
                            </div>

                            <div style="margin-top: 1rem;">
                                <label for="specificElements">√âl√©ments sp√©cifiques √† inclure (optionnel)</label>
                                <textarea id="specificElements" placeholder="Ex: √©toiles, flammes, nuages, motifs g√©om√©triques..."></textarea>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Boutons d'action -->
                <div class="button-group">
                    <button class="generate-btn" onclick="generatePrompt()">G√©n√©rer le prompt ‚ú®</button>
                    <button class="generate-btn secondary" onclick="generateVariations()">G√©n√©rer 3 variations üé≤</button>
                </div>

                <!-- Section de r√©sultats -->
                <div id="outputSection" class="output-section">
                    <div class="prompt-box">
                        <h3>
                            <span id="positiveTitle">‚ú® Prompt Positif</span>
                            <div class="action-buttons">
                                <button class="copy-btn" onclick="copyPrompt('positivePrompt', event)">üìã Copier</button>
                                <button class="save-btn" onclick="saveToHistory()">üíæ Sauvegarder</button>
                                <button class="export-btn" onclick="exportToPDF()">üìÑ PDF</button>
                            </div>
                        </h3>
                        <div class="prompt-content" id="positivePrompt"></div>
                    </div>

                    <div id="variationsSection" class="hidden">
                        <h3 style="font-family: 'Space Mono', monospace; color: var(--accent-secondary); margin-bottom: 1rem;">üé≤ Variations g√©n√©r√©es</h3>
                        <div class="variations-container" id="variationsContainer"></div>
                    </div>

                    <div class="prompt-box">
                        <h3>
                            <span id="negativeTitle">üö´ Prompt N√©gatif</span>
                            <button class="copy-btn" onclick="copyPrompt('negativePrompt', event)">üìã Copier</button>
                        </h3>
                        <div class="prompt-content" id="negativePrompt"></div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- Modal pour historique complet -->
    <div id="historyModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>üìö Historique complet</h3>
                <button class="close-modal" onclick="closeModal('historyModal')">√ó</button>
            </div>
            <div id="fullHistoryList"></div>
        </div>
    </div>

    <script>
        // √âtat global de l'application
        let appState = {
            mode: 'guided',
            language: 'fr',
            history: [],
            currentPrompt: null,
            currentTag: null
        };

        // Charger l'historique depuis localStorage
        function loadHistory() {
            const saved = localStorage.getItem('promptHistory');
            if (saved) {
                appState.history = JSON.parse(saved);
                updateRecentHistory();
            }
        }

        // Sauvegarder l'historique
        function saveHistory() {
            localStorage.setItem('promptHistory', JSON.stringify(appState.history));
        }

        // Initialisation
        document.addEventListener('DOMContentLoaded', function() {
            loadHistory();
            loadExamples();
            updateLanguage();
        });

        // Basculer entre mode guid√© et expert
        function switchMode(mode) {
            appState.mode = mode;
            document.querySelectorAll('.mode-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            const body = document.body;
            if (mode === 'expert') {
                body.classList.add('expert-mode');
            } else {
                body.classList.remove('expert-mode');
            }
        }

        // Gestion des sections repliables
        function toggleSection(header) {
            const section = header.parentElement;
            section.classList.toggle('collapsed');
        }

        // Mise √† jour de la langue
        function updateLanguage() {
            appState.language = document.getElementById('languageToggle').checked ? 'en' : 'fr';
            // Mettre √† jour tous les textes de l'interface
            updateCharacterInputs();
        }

        // Changement de produit
        function onProductChange() {
            const productType = document.getElementById('productType').value;
            toggleCustomProductField();
            updateProductPreview(productType);
            showProductSuggestions(productType);
            checkCompatibility();
        }

        // Aper√ßu visuel du produit
        function updateProductPreview(productType) {
            const preview = document.getElementById('productPreview');
            const icons = {
                tshirt: 'üëï', sweatshirt: 'üëï', hoodie: 'üß•', polo: 'üëî', tank: 'üéΩ',
                jacket: 'üß•', cap: 'üß¢', beanie: 'üé©', tote: 'üëú', backpack: 'üéí',
                poster: 'üñºÔ∏è', canvas: 'üé®', frame: 'üñºÔ∏è', sticker: 'üè∑Ô∏è', mug: '‚òï',
                waterbottle: 'üç∂', phonecase: 'üì±', mousepad: 'üñ±Ô∏è', pillow: 'üõèÔ∏è',
                blanket: 'üõèÔ∏è', towel: 'üß∫', napkin: 'üçΩÔ∏è', apron: 'üë®‚Äçüç≥', magnet: 'üß≤',
                coaster: 'ü•§', puzzle: 'üß©', calendar: 'üìÖ', notebook: 'üìì',
                pingpong: 'üèì', football: '‚öΩ', basketball: 'üèÄ', tennis: 'üéæ',
                frisbee: 'ü•è', skateboard: 'üõπ', canette: 'ü•´', beerlabel: 'üç∫',
                custom: '‚ú®'
            };
            preview.textContent = icons[productType] || 'üì¶';
        }

        // Suggestions intelligentes par produit
        function showProductSuggestions(productType) {
            const suggestions = {
                tshirt: ['vintage', 'cartoon', 'minimalist', 'grunge'],
                mug: ['kawaii', 'cartoon', 'minimalist'],
                poster: ['pop art', 'abstract', 'modern', 'realistic'],
                hoodie: ['grunge', 'cyberpunk', 'modern'],
                cap: ['minimalist', 'graffiti street art', 'vintage'],
                tote: ['minimalist', 'cartoon', 'pop art'],
                sticker: ['kawaii', 'cartoon', 'neon'],
                phonecase: ['minimalist', 'cyberpunk', 'kawaii', 'abstract']
            };

            const productSuggestions = suggestions[productType];
            if (productSuggestions) {
                const container = document.getElementById('styleSuggestions');
                const lang = appState.language;
                container.innerHTML = '';
                productSuggestions.forEach(style => {
                    const tag = document.createElement('span');
                    tag.className = 'suggestion-tag';
                    tag.textContent = style;
                    tag.onclick = () => {
                        document.getElementById('aesthetic').value = style;
                        onAestheticChange();
                    };
                    container.appendChild(tag);
                });
                document.getElementById('productSuggestions').classList.remove('hidden');
            } else {
                document.getElementById('productSuggestions').classList.add('hidden');
            }
        }

        // Changement d'esth√©tique
        function onAestheticChange() {
            toggleCustomAesthetic();
            checkCompatibility();
        }

        // Changement de couleurs
        function onColorChange() {
            toggleCustomColors();
            checkCompatibility();
        }

        // V√©rification de compatibilit√©
        function checkCompatibility() {
            const aesthetic = document.getElementById('aesthetic').value;
            const colors = document.getElementById('colors').value;
            const format = document.getElementById('format').value;
            const warning = document.getElementById('compatibilityWarning');
            const warningText = document.getElementById('warningText');
            const lang = appState.language;

            let warnings = [];

            // V√©rifier les combinaisons probl√©matiques
            if (aesthetic === 'watercolor' && colors === 'neon bright') {
                warnings.push(lang === 'fr' 
                    ? 'Aquarelle + n√©on peut √™tre difficile √† r√©aliser harmonieusement'
                    : 'Watercolor + neon can be difficult to achieve harmoniously');
            }

            if (aesthetic === 'minimalist' && colors === 'vibrant rainbow') {
                warnings.push(lang === 'fr'
                    ? 'Minimalisme + arc-en-ciel vibrant sont des styles oppos√©s'
                    : 'Minimalist + vibrant rainbow are opposing styles');
            }

            if (aesthetic === 'realistic' && format === 'circle') {
                warnings.push(lang === 'fr'
                    ? 'Format circulaire peut limiter les compositions r√©alistes'
                    : 'Circular format may limit realistic compositions');
            }

            if (warnings.length > 0) {
                warningText.textContent = warnings.join('. ');
                warning.classList.add('show');
            } else {
                warning.classList.remove('show');
            }
        }

        // Fonction "Surprends-moi !"
        function surpriseMe() {
            const lang = appState.language;
            
            // Produits al√©atoires
            const products = ['tshirt', 'mug', 'poster', 'hoodie', 'sticker', 'tote', 'phonecase'];
            const randomProduct = products[Math.floor(Math.random() * products.length)];
            
            // Styles al√©atoires
            const aesthetics = ['minimalist', 'vintage', 'cartoon', 'pop art', 'cyberpunk', 'kawaii'];
            const randomAesthetic = aesthetics[Math.floor(Math.random() * aesthetics.length)];
            
            // Ambiances al√©atoires
            const moods = ['joyful energetic', 'playful fun', 'elegant sophisticated', 'dramatic epic'];
            const randomMood = moods[Math.floor(Math.random() * moods.length)];
            
            // Couleurs al√©atoires
            const colorPalettes = ['vibrant rainbow', 'pastel soft', 'monochrome black and white', 'neon bright'];
            const randomColors = colorPalettes[Math.floor(Math.random() * colorPalettes.length)];

            // Appliquer les valeurs
            document.getElementById('productType').value = randomProduct;
            onProductChange();
            
            document.getElementById('aesthetic').value = randomAesthetic;
            onAestheticChange();
            
            document.getElementById('mood').value = randomMood;
            document.getElementById('colors').value = randomColors;
            
            document.getElementById('format').value = 'square';
            
            // Message de confirmation
            alert(lang === 'fr' 
                ? '‚ú® Design surprise g√©n√©r√© ! D√©couvrez votre cr√©ation al√©atoire !' 
                : '‚ú® Surprise design generated! Discover your random creation!');
            
            // Scroll vers le haut
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // Charger les exemples
        function loadExamples() {
            const examples = [
                { icon: 'üéÇ', name: 'Anniversaire Papa', product: 'mug', style: 'vintage' },
                { icon: 'üíº', name: 'Logo Entreprise', product: 'tshirt', style: 'minimalist' },
                { icon: 'üòÑ', name: 'Citation Dr√¥le', product: 'poster', style: 'cartoon' },
                { icon: '‚öΩ', name: 'Team Sports', product: 'hoodie', style: 'modern' },
                { icon: '‚ù§Ô∏è', name: 'Cadeau Couple', product: 'pillow', style: 'romantic dreamy' }
            ];

            const container = document.getElementById('examplesLibrary');
            container.innerHTML = '';
            
            examples.forEach(example => {
                const item = document.createElement('div');
                item.className = 'example-item';
                item.innerHTML = `
                    <div class="example-preview">${example.icon}</div>
                    <strong>${example.name}</strong>
                `;
                item.onclick = () => loadExample(example);
                container.appendChild(item);
            });
        }

        // Charger un exemple
        function loadExample(example) {
            document.getElementById('productType').value = example.product;
            onProductChange();
            document.getElementById('aesthetic').value = example.style;
            onAestheticChange();
            
            const lang = appState.language;
            alert(lang === 'fr' 
                ? `üìã Exemple "${example.name}" charg√© !` 
                : `üìã Example "${example.name}" loaded!`);
        }

        // Filtrer par tag
        function filterByTag(tag) {
            appState.currentTag = tag;
            const lang = appState.language;
            alert(lang === 'fr' 
                ? `üè∑Ô∏è Filtrage par cat√©gorie: ${tag}` 
                : `üè∑Ô∏è Filtering by category: ${tag}`);
        }

        // Mise √† jour de l'historique r√©cent
        function updateRecentHistory() {
            const container = document.getElementById('recentHistory');
            const recent = appState.history.slice(-5).reverse();
            
            if (recent.length === 0) {
                container.innerHTML = '<p style="color: var(--text-secondary); font-size: 0.85rem;">Aucun historique</p>';
                return;
            }

            container.innerHTML = '';
            recent.forEach((item, index) => {
                const historyItem = document.createElement('div');
                historyItem.className = 'history-item';
                historyItem.innerHTML = `
                    <strong>${item.product || 'Design'}</strong>
                    <div class="timestamp">${new Date(item.timestamp).toLocaleString()}</div>
                `;
                historyItem.onclick = () => loadFromHistory(item);
                container.appendChild(historyItem);
            });
        }

        // Charger depuis l'historique
        function loadFromHistory(item) {
            // Restaurer les valeurs
            if (item.formData) {
                Object.keys(item.formData).forEach(key => {
                    const element = document.getElementById(key);
                    if (element) {
                        element.value = item.formData[key];
                    }
                });
            }
            
            const lang = appState.language;
            alert(lang === 'fr' 
                ? 'üìã Configuration restaur√©e !' 
                : 'üìã Configuration restored!');
        }

        // Ouvrir modal d'historique
        function openHistoryModal() {
            const modal = document.getElementById('historyModal');
            const list = document.getElementById('fullHistoryList');
            
            list.innerHTML = '';
            appState.history.reverse().forEach((item, index) => {
                const historyItem = document.createElement('div');
                historyItem.className = 'history-item';
                historyItem.innerHTML = `
                    <strong>${item.product || 'Design'} - ${item.aesthetic || ''}</strong>
                    <div class="timestamp">${new Date(item.timestamp).toLocaleString()}</div>
                `;
                historyItem.onclick = () => {
                    loadFromHistory(item);
                    closeModal('historyModal');
                };
                list.appendChild(historyItem);
            });
            
            modal.classList.add('show');
        }

        // Fermer modal
        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('show');
        }

        // Sauvegarder dans l'historique
        function saveToHistory() {
            const formData = {
                productType: document.getElementById('productType').value,
                format: document.getElementById('format').value,
                aesthetic: document.getElementById('aesthetic').value,
                characterCount: document.getElementById('characterCount').value,
                mood: document.getElementById('mood').value,
                colors: document.getElementById('colors').value,
                titleText: document.getElementById('titleText').value
            };

            const historyEntry = {
                timestamp: Date.now(),
                product: document.getElementById('productType').options[document.getElementById('productType').selectedIndex].text,
                aesthetic: document.getElementById('aesthetic').value,
                prompt: document.getElementById('positivePrompt').textContent,
                formData: formData
            };

            appState.history.push(historyEntry);
            saveHistory();
            updateRecentHistory();

            const lang = appState.language;
            alert(lang === 'fr' 
                ? 'üíæ Sauvegard√© dans l\'historique !' 
                : 'üíæ Saved to history!');
        }

        // Export PDF
        function exportToPDF() {
            const lang = appState.language;
            const positivePrompt = document.getElementById('positivePrompt').textContent;
            const negativePrompt = document.getElementById('negativePrompt').textContent;
            
            // Cr√©er un contenu format√© pour l'export
            const content = `
GENERATEUR DE PROMPTS - BRIEF COMPLET
======================================

Date: ${new Date().toLocaleDateString()}

PROMPT POSITIF:
${positivePrompt}

PROMPT NEGATIF:
${negativePrompt}

---
G√©n√©r√© par G√©n√©rateur de Prompts Pro v4.0
            `.trim();

            // Cr√©er un blob et t√©l√©charger
            const blob = new Blob([content], { type: 'text/plain;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `prompt-brief-${Date.now()}.txt`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);

            alert(lang === 'fr' 
                ? 'üìÑ Brief export√© en TXT ! (PDF n√©cessite une biblioth√®que externe)' 
                : 'üìÑ Brief exported as TXT! (PDF requires external library)');
        }

        // Toggle functions (m√™mes que v3)
        function toggleParodyField() {
            const mode = document.getElementById('creationMode').value;
            const parodyFields = document.getElementById('parodyFields');
            parodyFields.classList.toggle('hidden', mode !== 'parody');
        }

        function toggleCustomParody() {
            const ref = document.getElementById('parodyReference').value;
            const customField = document.getElementById('customParodyField');
            customField.classList.toggle('hidden', ref !== 'custom');
        }

        function toggleCustomAesthetic() {
            const aesthetic = document.getElementById('aesthetic').value;
            const customField = document.getElementById('customAestheticField');
            customField.classList.toggle('hidden', aesthetic !== 'custom');
        }

        function toggleCustomFont() {
            const font = document.getElementById('textFont').value;
            const customField = document.getElementById('customFontField');
            customField.classList.toggle('hidden', font !== 'custom');
        }

        function toggleCustomTextColor() {
            const color = document.getElementById('textColor').value;
            const customField = document.getElementById('customTextColorField');
            customField.classList.toggle('hidden', color !== 'custom');
        }

        function toggleLogoFields() {
            const includeLogo = document.getElementById('includeLogo').value;
            const logoFields = document.getElementById('logoFields');
            logoFields.classList.toggle('hidden', includeLogo !== 'yes');
        }

        function toggleCustomMood() {
            const mood = document.getElementById('mood').value;
            const customField = document.getElementById('customMoodField');
            customField.classList.toggle('hidden', mood !== 'custom');
        }

        function toggleCustomColors() {
            const colors = document.getElementById('colors').value;
            const customField = document.getElementById('customColorsField');
            customField.classList.toggle('hidden', colors !== 'custom');
        }

        function toggleCustomProductField() {
            const productType = document.getElementById('productType').value;
            const customField = document.getElementById('customProductField');
            customField.classList.toggle('hidden', productType !== 'custom');
        }

        function updateCharacterInputs() {
            const count = parseInt(document.getElementById('characterCount').value);
            const container = document.getElementById('characterInputs');
            const interactionField = document.getElementById('characterInteractionField');
            const lang = appState.language;
            
            container.innerHTML = '';
            
            // Afficher le champ d'interaction seulement s'il y a 2+ personnages
            interactionField.classList.toggle('hidden', count < 2);
            
            for (let i = 1; i <= count; i++) {
                const charDiv = document.createElement('div');
                charDiv.className = 'character-input';
                charDiv.innerHTML = `
                    <h3>${lang === 'fr' ? 'Personnage' : 'Character'} ${i}</h3>
                    <textarea id="char${i}desc" placeholder="${lang === 'fr' ? 'Description (apparence, v√™tements, pose, expression...)' : 'Description (appearance, clothing, pose, expression...)'}"></textarea>
                `;
                container.appendChild(charDiv);
            }
        }

        // Traductions (m√™me objet que v3)
        const translations = {
            productType: {
                tshirt: { fr: 'design pour t-shirt', en: 't-shirt design' },
                sweatshirt: { fr: 'design pour sweatshirt', en: 'sweatshirt design' },
                hoodie: { fr: 'design pour hoodie', en: 'hoodie design' },
                polo: { fr: 'design pour polo', en: 'polo shirt design' },
                tank: { fr: 'design pour d√©bardeur', en: 'tank top design' },
                jacket: { fr: 'design pour veste', en: 'jacket design' },
                cap: { fr: 'design pour casquette', en: 'cap design' },
                beanie: { fr: 'design pour bonnet', en: 'beanie design' },
                tote: { fr: 'design pour tote bag', en: 'tote bag design' },
                backpack: { fr: 'design pour sac √† dos', en: 'backpack design' },
                poster: { fr: 'design de poster', en: 'poster design' },
                canvas: { fr: 'design sur toile', en: 'canvas design' },
                frame: { fr: 'design pour cadre photo', en: 'photo frame design' },
                sticker: { fr: 'design de sticker', en: 'sticker design' },
                mug: { fr: 'design pour mug', en: 'mug design' },
                waterbottle: { fr: 'design pour gourde', en: 'water bottle design' },
                phonecase: { fr: 'design pour coque de t√©l√©phone', en: 'phone case design' },
                mousepad: { fr: 'design pour tapis de souris', en: 'mousepad design' },
                pillow: { fr: 'design pour coussin', en: 'pillow design' },
                blanket: { fr: 'design pour couverture', en: 'blanket design' },
                towel: { fr: 'design pour serviette de bain', en: 'bath towel design' },
                napkin: { fr: 'design pour serviette de table', en: 'table napkin design' },
                apron: { fr: 'design pour tablier', en: 'apron design' },
                magnet: { fr: 'design pour magnet', en: 'magnet design' },
                coaster: { fr: 'design pour dessous de verre', en: 'coaster design' },
                puzzle: { fr: 'design pour puzzle', en: 'puzzle design' },
                calendar: { fr: 'design pour calendrier', en: 'calendar design' },
                notebook: { fr: 'design pour carnet', en: 'notebook design' },
                pingpong: { fr: 'design pour raquette de ping-pong', en: 'ping-pong paddle design' },
                football: { fr: 'design pour ballon de football', en: 'football design' },
                basketball: { fr: 'design pour ballon de basket', en: 'basketball design' },
                tennis: { fr: 'design pour balle de tennis', en: 'tennis ball design' },
                frisbee: { fr: 'design pour frisbee', en: 'frisbee design' },
                skateboard: { fr: 'design pour skateboard', en: 'skateboard design' },
                canette: { fr: 'design pour canette', en: 'can design' },
                beerlabel: { fr: 'design d\'√©tiquette pour bouteille', en: 'bottle label design' },
                custom: { fr: 'design personnalis√© pour', en: 'custom design for' }
            },
            format: {
                square: { fr: 'format carr√©', en: 'square format' },
                portrait: { fr: 'format portrait', en: 'portrait format' },
                landscape: { fr: 'format paysage', en: 'landscape format' },
                circle: { fr: 'format circulaire', en: 'circular format' },
                custom: { fr: 'format personnalis√©', en: 'custom format' }
            },
            parody: {
                fr: 'parodie de style',
                en: 'parody of'
            },
            aesthetic: {
                fr: 'style',
                en: 'style'
            },
            characters: {
                fr: 'avec',
                en: 'featuring',
                character: { fr: 'personnage', en: 'character' },
                characters: { fr: 'personnages', en: 'characters' },
                interaction: { fr: 'interagissant:', en: 'interacting:' }
            },
            atmosphere: {
                fr: 'ambiance',
                en: 'mood'
            },
            including: {
                fr: 'incluant',
                en: 'including'
            },
            title: {
                fr: 'texte principal',
                en: 'main text'
            },
            subtitle: {
                fr: 'sous-titre',
                en: 'subtitle'
            },
            additional: {
                fr: 'texte additionnel',
                en: 'additional text'
            },
            typography: {
                fr: 'typographie',
                en: 'typography'
            },
            color: {
                fr: 'couleur',
                en: 'color'
            },
            in: {
                fr: 'en',
                en: 'in'
            },
            logo: {
                fr: 'logo',
                en: 'logo'
            },
            positioned: {
                fr: 'positionn√©',
                en: 'positioned'
            },
            logoPosition: {
                top: { fr: 'en haut', en: 'at the top' },
                bottom: { fr: 'en bas', en: 'at the bottom' },
                left: { fr: '√† gauche', en: 'on the left' },
                right: { fr: '√† droite', en: 'on the right' },
                center: { fr: 'au centre', en: 'in the center' },
                corner: { fr: 'dans un coin', en: 'in a corner' }
            },
            quality: {
                fr: 'haute qualit√©, ultra d√©taill√©, rendu professionnel, composition √©quilibr√©e, couleurs vibrantes',
                en: 'high quality, ultra detailed, professional rendering, balanced composition, vibrant colors'
            },
            contrast: {
                fr: 'couleur √† contraste √©lev√© pour visibilit√©',
                en: 'high contrast color for visibility'
            }
        };

        const negativePrompts = {
            fr: 'mains mal dessin√©es, pieds mal dessin√©s, visage mal dessin√©, mauvaise anatomie, membres suppl√©mentaires, membres manquants, d√©figur√©, d√©form√©, flou, mauvaises proportions, doigts suppl√©mentaires, moins de doigts, doigts fusionn√©s, mains mut√©es, membres flottants, membres d√©connect√©s, hors cadre, recadr√©, basse qualit√©, pire qualit√©, artefacts jpeg, filigrane, signature, nom d\'utilisateur, logo, dupliqu√©, distordu, pixellis√©, basse r√©solution, surexpos√©, sous-expos√©, mauvais √©clairage, √©clairage plat, mauvaise composition, mauvais cadrage, mauvaise perspective, inclin√©, d√©s√©quilibr√©, mauvaise profondeur de champ, d√©coupage, g√©om√©trie qui se croise, objets flottants, ombres incorrectes, ombres manquantes, √©clairage incoh√©rent, bruit, grain, sursatur√©, sous-satur√©, aberration chromatique, artefacts, glitchs, erreurs anatomiques, pose non naturelle, pose raide, yeux asym√©triques, mal rendu, manque de d√©tails, trop liss√©, sur-accentu√©, texte mal orthographi√©, fautes d\'orthographe, fautes de frappe, erreurs grammaticales, lettres incorrectes, texte illisible, charabia, texte absurde, texte brouill√©, texte non lisible, texte mal √©crit, orthographe incorrecte, lettres mal form√©es, texte d√©form√©, texte flou, texte pixellis√©, texte cass√©, texte fragment√©, texte √† l\'envers, texte invers√©, mauvaise police, police incoh√©rente, polices m√©lang√©es',
            en: 'poorly drawn hands, poorly drawn feet, poorly drawn face, bad anatomy, extra limbs, missing limbs, disfigured, deformed, blurry, bad proportions, extra fingers, fewer fingers, fused fingers, mutated hands, floating limbs, disconnected limbs, out of frame, cropped, low quality, worst quality, jpeg artifacts, watermark, signature, username, logo, duplicate, distorted, pixelated, low resolution, overexposed, underexposed, bad lighting, flat lighting, bad composition, bad framing, bad perspective, tilted, unbalanced, bad depth of field, clipping, intersecting geometry, floating objects, wrong shadows, missing shadows, inconsistent lighting, noise, grain, oversaturated, undersaturated, chromatic aberration, artefacts, glitches, anatomical errors, unnatural pose, stiff pose, asymmetric eyes, poorly rendered, lack of detail, oversmoothed, oversharpened, misspelled text, spelling errors, typos, grammatical errors, wrong letters, illegible text, gibberish text, nonsense text, garbled text, unreadable text, badly written text, incorrect spelling, malformed letters, distorted text, blurry text, pixelated text, broken text, fragmented text, backwards text, upside down text, wrong font, inconsistent font, mixed fonts'
        };

        // Fonction de g√©n√©ration principale
        function generatePrompt() {
            const lang = appState.language;

            // R√©cup√©ration des valeurs
            const productType = document.getElementById('productType').value;
            const customProduct = document.getElementById('customProduct').value;
            const format = document.getElementById('format').value;
            const creationMode = document.getElementById('creationMode').value;
            const parodyRef = document.getElementById('parodyReference').value;
            const customParody = document.getElementById('customParody').value;
            const aesthetic = document.getElementById('aesthetic').value;
            const customAesthetic = document.getElementById('customAesthetic').value;
            const characterCount = parseInt(document.getElementById('characterCount').value);
            const titleText = document.getElementById('titleText').value;
            const textFont = document.getElementById('textFont').value;
            const customFont = document.getElementById('customFont').value;
            const textColor = document.getElementById('textColor').value;
            const customTextColor = document.getElementById('customTextColor').value;
            const subtitleText = document.getElementById('subtitleText').value;
            const additionalText = document.getElementById('additionalText').value;
            const includeLogo = document.getElementById('includeLogo').value;
            const logoDescription = document.getElementById('logoDescription').value;
            const logoPosition = document.getElementById('logoPosition').value;
            const mood = document.getElementById('mood').value;
            const customMood = document.getElementById('customMood').value;
            const colors = document.getElementById('colors').value;
            const customColors = document.getElementById('customColors').value;
            const specificElements = document.getElementById('specificElements').value;

            // V√©rifications basiques
            if (!productType) {
                alert(lang === 'fr' ? 'Veuillez s√©lectionner un type de produit' : 'Please select a product type');
                return;
            }

            // Construction du prompt positif
            let positivePrompt = '';

            // Type de produit
            if (productType === 'custom' && customProduct) {
                positivePrompt += translations.productType[productType][lang] + ' ' + customProduct;
            } else {
                positivePrompt += translations.productType[productType][lang];
            }

            // Format
            if (format) {
                positivePrompt += `, ${translations.format[format][lang]}`;
            }

            // R√©f√©rence de parodie
            if (creationMode === 'parody') {
                const reference = customParody || parodyRef;
                if (reference) {
                    positivePrompt += `, ${translations.parody[lang]} ${reference}`;
                }
            }

            // Esth√©tique
            const finalAesthetic = customAesthetic || aesthetic;
            if (finalAesthetic) {
                positivePrompt += `, ${finalAesthetic} ${translations.aesthetic[lang]}`;
            }

            // Personnages
            if (characterCount > 0) {
                const charWord = characterCount > 1 ? translations.characters.characters[lang] : translations.characters.character[lang];
                positivePrompt += `, ${translations.characters[lang]} ${characterCount} ${charWord}`;
                for (let i = 1; i <= characterCount; i++) {
                    const charDesc = document.getElementById('char' + i + 'desc').value;
                    if (charDesc) {
                        positivePrompt += `, ${translations.characters.character[lang]} ${i}: ${charDesc}`;
                    }
                }
                
                // Ajouter l'interaction si elle existe
                const characterInteraction = document.getElementById('characterInteraction').value;
                if (characterInteraction && characterCount >= 2) {
                    positivePrompt += `, ${translations.characters.interaction[lang]} ${characterInteraction}`;
                }
            }

            // Ambiance
            const finalMood = customMood || mood;
            if (finalMood) {
                positivePrompt += `, ${finalMood} ${translations.atmosphere[lang]}`;
            }

            // Couleurs
            const finalColors = customColors || colors;
            if (finalColors) {
                positivePrompt += `, ${finalColors}`;
            }

            // √âl√©ments sp√©cifiques
            if (specificElements) {
                positivePrompt += `, ${translations.including[lang]} ${specificElements}`;
            }

            // Texte - avec police et couleur
            if (titleText) {
                let textStyle = '';
                const finalFont = customFont || textFont;
                if (finalFont) {
                    textStyle += `${finalFont} ${translations.typography[lang]}`;
                }
                const finalTextColor = customTextColor || textColor;
                if (finalTextColor) {
                    textStyle += textStyle ? `, ${finalTextColor} ${translations.color[lang]}` : `${finalTextColor} ${translations.color[lang]}`;
                }
                positivePrompt += `, ${translations.title[lang]} "${titleText}"`;
                if (textStyle) {
                    positivePrompt += ` ${translations.in[lang]} ${textStyle}`;
                }
            }
            if (subtitleText) {
                positivePrompt += `, ${translations.subtitle[lang]} "${subtitleText}"`;
            }
            if (additionalText) {
                positivePrompt += `, ${translations.additional[lang]} "${additionalText}"`;
            }

            // Logo
            if (includeLogo === 'yes' && logoDescription) {
                positivePrompt += `, ${translations.logo[lang]} (${logoDescription}) ${translations.positioned[lang]} ${translations.logoPosition[logoPosition][lang]}, ${translations.contrast[lang]}`;
            }

            // Qualit√© g√©n√©rale
            positivePrompt += `, ${translations.quality[lang]}`;

            // Prompt n√©gatif
            const negativePrompt = negativePrompts[lang];

            // Affichage
            document.getElementById('positivePrompt').textContent = positivePrompt;
            document.getElementById('negativePrompt').textContent = negativePrompt;
            
            // Mise √† jour des titres
            document.getElementById('positiveTitle').textContent = lang === 'fr' ? '‚ú® Prompt Positif' : '‚ú® Positive Prompt';
            document.getElementById('negativeTitle').textContent = lang === 'fr' ? 'üö´ Prompt N√©gatif' : 'üö´ Negative Prompt';
            
            // Masquer les variations si affich√©es
            document.getElementById('variationsSection').classList.add('hidden');
            
            document.getElementById('outputSection').classList.add('active');

            // Sauvegarder le prompt actuel
            appState.currentPrompt = positivePrompt;

            // Scroll vers les r√©sultats
            document.getElementById('outputSection').scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        // G√©n√©rer des variations
        function generateVariations() {
            // D'abord g√©n√©rer le prompt principal
            generatePrompt();
            
            if (!appState.currentPrompt) return;

            const lang = appState.language;
            const basePrompt = appState.currentPrompt;
            
            // Cr√©er 3 variations
            const variations = [
                { 
                    label: lang === 'fr' ? 'Variation 1: Plus color√©' : 'Variation 1: More colorful',
                    prompt: basePrompt + (lang === 'fr' ? ', couleurs plus vives et satur√©es' : ', more vivid and saturated colors')
                },
                {
                    label: lang === 'fr' ? 'Variation 2: Plus sobre' : 'Variation 2: More subtle',
                    prompt: basePrompt + (lang === 'fr' ? ', palette de couleurs douces et minimalistes' : ', soft and minimalist color palette')
                },
                {
                    label: lang === 'fr' ? 'Variation 3: Style mixte' : 'Variation 3: Mixed style',
                    prompt: basePrompt + (lang === 'fr' ? ', m√©lange de styles moderne et vintage' : ', blend of modern and vintage styles')
                }
            ];

            // Afficher les variations
            const container = document.getElementById('variationsContainer');
            container.innerHTML = '';
            
            variations.forEach((variation, index) => {
                const varBox = document.createElement('div');
                varBox.className = 'variation-box';
                varBox.innerHTML = `
                    <div class="variation-label">${variation.label}</div>
                    <div style="font-size: 0.85rem; line-height: 1.6;">${variation.prompt}</div>
                `;
                varBox.onclick = () => {
                    // S√©lectionner cette variation
                    document.querySelectorAll('.variation-box').forEach(box => box.classList.remove('selected'));
                    varBox.classList.add('selected');
                    document.getElementById('positivePrompt').textContent = variation.prompt;
                    appState.currentPrompt = variation.prompt;
                };
                container.appendChild(varBox);
            });

            document.getElementById('variationsSection').classList.remove('hidden');
        }

        // Copier le prompt
        function copyPrompt(elementId, event) {
            const text = document.getElementById(elementId).textContent;
            const lang = appState.language;
            
            navigator.clipboard.writeText(text).then(() => {
                // Feedback visuel
                const btn = event.target;
                const originalText = btn.textContent;
                btn.style.background = '#4caf50';
                btn.textContent = lang === 'fr' ? '‚úì Copi√© !' : '‚úì Copied!';
                setTimeout(() => {
                    btn.textContent = originalText;
                    btn.style.background = '';
                }, 2000);
            }).catch(err => {
                alert((lang === 'fr' ? 'Erreur lors de la copie : ' : 'Copy error: ') + err);
            });
        }
    </script>
</body>
</html>

<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>G√©n√©rateur de Prompts Personnalis√©s - √âDITION COMPL√àTE</title>
<style>
:root {
  --primary: #0a0a1a;
  --secondary: #1a1a3a;
  --accent: #00d4ff;
  --accent2: #ff6b6b;
  --accent3: #4ecdc4;
  --accent4: #9d4edd;
  --text: #e8f4ff;
  --card-bg: rgba(0, 20, 40, 0.8);
  --card-bg2: rgba(10, 30, 60, 0.6);
}

* {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

body {
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  background: linear-gradient(135deg, var(--primary), var(--secondary));
  color: var(--text);
  padding: 20px;
  line-height: 1.6;
  min-height: 100vh;
}

.container {
  max-width: 2000px;
  margin: 0 auto;
  background: linear-gradient(135deg, var(--card-bg), var(--card-bg2));
  padding: 40px;
  border-radius: 30px;
  box-shadow: 0 30px 100px rgba(0, 212, 255, 0.2);
  backdrop-filter: blur(20px);
  border: 1px solid rgba(0, 212, 255, 0.1);
}

h1 {
  text-align: center;
  font-size: 2.8em;
  margin-bottom: 20px;
  text-shadow: 0 0 30px var(--accent);
  background: linear-gradient(to right, #00d4ff, #ff6b6b, #9d4edd);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
}

.subtitle {
  text-align: center;
  font-size: 1.3em;
  margin-bottom: 40px;
  color: #88ccff;
}

/* GRID SYSTEM */
.grid-container {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
  gap: 25px;
  margin-bottom: 30px;
}

.section {
  background: rgba(0, 10, 25, 0.5);
  border-radius: 20px;
  padding: 25px;
  border-left: 5px solid var(--accent);
  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
  transition: transform 0.3s;
}

.section:hover {
  transform: translateY(-5px);
}

.section-title {
  font-size: 1.4em;
  margin-bottom: 20px;
  color: var(--accent);
  border-bottom: 2px solid var(--accent);
  padding-bottom: 10px;
  display: flex;
  align-items: center;
  gap: 10px;
}

.section-title::before {
  content: "‚ú¶";
  font-size: 1.2em;
}

/* FORM ELEMENTS */
select, input[type="text"], textarea {
  width: 100%;
  padding: 14px;
  font-size: 16px;
  border-radius: 12px;
  border: 2px solid var(--accent);
  background: rgba(0, 0, 0, 0.7);
  color: white;
  margin-bottom: 15px;
  transition: all 0.3s;
  cursor: pointer;
}

select:focus, input[type="text"]:focus, textarea:focus {
  outline: none;
  box-shadow: 0 0 20px var(--accent);
  border-color: #00ff88;
}

select option {
  background: #0a0a2a;
  padding: 10px;
}

.custom-input {
  margin-top: 10px;
  border-color: #ff6b6b !important;
}

.custom-input::placeholder {
  color: #ff9999;
}

.input-group {
  position: relative;
  margin-bottom: 15px;
}

.input-label {
  display: block;
  margin-bottom: 8px;
  color: #88ccff;
  font-size: 0.9em;
  font-weight: bold;
}

.input-hint {
  font-size: 0.8em;
  color: #66aaff;
  margin-top: 5px;
  padding: 5px 10px;
  background: rgba(0, 30, 60, 0.3);
  border-radius: 5px;
}

.checkbox-group {
  display: flex;
  flex-wrap: wrap;
  gap: 15px;
  margin: 20px 0;
}

.checkbox-item {
  display: flex;
  align-items: center;
  gap: 8px;
}

.checkbox-item input {
  width: 18px;
  height: 18px;
}

/* PROMPT OUTPUT */
.prompt-container {
  margin-top: 40px;
  padding: 30px;
  background: linear-gradient(135deg, #000, #111, #000);
  border-radius: 20px;
  border: 3px solid var(--accent);
  box-shadow: inset 0 0 30px rgba(0, 255, 136, 0.1);
}

#promptOutput {
  width: 100%;
  min-height: 300px;
  background: transparent;
  color: #00ff88;
  font-family: 'Fira Code', 'Consolas', monospace;
  font-size: 16px;
  line-height: 1.5;
  padding: 20px;
  border: none;
  resize: vertical;
  border-radius: 10px;
}

/* BUTTONS */
.button-group {
  display: flex;
  justify-content: center;
  flex-wrap: wrap;
  gap: 20px;
  margin: 30px 0;
}

button {
  padding: 18px 35px;
  font-size: 18px;
  border-radius: 15px;
  border: none;
  cursor: pointer;
  font-weight: bold;
  transition: all 0.3s;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 10px;
  min-width: 200px;
}

#generateBtn {
  background: linear-gradient(135deg, #00d4ff, #00b8ff);
  color: #000;
  font-size: 20px;
}

#randomAllBtn {
  background: linear-gradient(135deg, #ff6b6b, #ff8e8e);
  color: white;
}

#copyBtn {
  background: linear-gradient(135deg, #4ecdc4, #44a08d);
  color: #000;
}

#clearBtn {
  background: linear-gradient(135deg, #9d4edd, #560bad);
  color: white;
}

button:hover {
  transform: translateY(-3px);
  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);
}

button:active {
  transform: translateY(0);
}

/* PERSONALITIES GRID */
.personalities-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
  gap: 15px;
  margin-top: 15px;
  max-height: 300px;
  overflow-y: auto;
  padding: 10px;
}

.personality-card {
  background: rgba(0, 20, 40, 0.6);
  border-radius: 10px;
  padding: 15px;
  text-align: center;
  cursor: pointer;
  transition: all 0.2s;
  border: 1px solid transparent;
}

.personality-card:hover {
  border-color: var(--accent);
  background: rgba(0, 40, 80, 0.6);
}

.personality-card.selected {
  border-color: #00ff88;
  background: rgba(0, 40, 30, 0.6);
}

.personality-category {
  font-size: 0.8em;
  color: #88ccff;
  margin-top: 5px;
}

/* CONTROLS */
.controls {
  display: flex;
  justify-content: space-between;
  align-items: center;
  flex-wrap: wrap;
  gap: 20px;
  margin: 25px 0;
  padding: 20px;
  background: rgba(0, 15, 30, 0.5);
  border-radius: 15px;
}

.control-group {
  display: flex;
  align-items: center;
  gap: 15px;
}

/* RESPONSIVE */
@media (max-width: 1200px) {
  .grid-container {
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
  }
}

@media (max-width: 768px) {
  .container {
    padding: 20px;
  }
  
  h1 {
    font-size: 2em;
  }
  
  .button-group {
    flex-direction: column;
  }
  
  button {
    width: 100%;
  }
  
  .controls {
    flex-direction: column;
    align-items: stretch;
  }
}

/* SCROLLBAR */
::-webkit-scrollbar {
  width: 10px;
}

::-webkit-scrollbar-track {
  background: rgba(0, 10, 25, 0.5);
  border-radius: 10px;
}

::-webkit-scrollbar-thumb {
  background: var(--accent);
  border-radius: 10px;
}

::-webkit-scrollbar-thumb:hover {
  background: #00b8ff;
}

/* COUNTER */
.counter {
  position: fixed;
  bottom: 20px;
  right: 20px;
  background: rgba(255, 107, 107, 0.9);
  color: white;
  width: 60px;
  height: 60px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 24px;
  font-weight: bold;
  box-shadow: 0 5px 20px rgba(255, 107, 107, 0.5);
  z-index: 1000;
}

/* TOOLTIPS */
.tooltip {
  position: relative;
  display: inline-block;
  margin-left: 5px;
}

.tooltip .tooltiptext {
  visibility: hidden;
  width: 200px;
  background-color: rgba(0, 0, 0, 0.9);
  color: #fff;
  text-align: center;
  border-radius: 6px;
  padding: 10px;
  position: absolute;
  z-index: 1;
  bottom: 125%;
  left: 50%;
  transform: translateX(-50%);
  opacity: 0;
  transition: opacity 0.3s;
  font-size: 14px;
}

.tooltip:hover .tooltiptext {
  visibility: visible;
  opacity: 1;
}

/* LOADING ANIMATION */
.loading {
  display: none;
  text-align: center;
  margin: 20px 0;
}

.loading span {
  display: inline-block;
  width: 10px;
  height: 10px;
  margin: 0 5px;
  background-color: var(--accent);
  border-radius: 50%;
  animation: loading 1.4s infinite ease-in-out both;
}

.loading span:nth-child(1) { animation-delay: -0.32s; }
.loading span:nth-child(2) { animation-delay: -0.16s; }

@keyframes loading {
  0%, 80%, 100% { transform: scale(0); }
  40% { transform: scale(1.0); }
}

/* SWITCH TOGGLE */
.switch {
  position: relative;
  display: inline-block;
  width: 60px;
  height: 30px;
}

.switch input {
  opacity: 0;
  width: 0;
  height: 0;
}

.slider {
  position: absolute;
  cursor: pointer;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: #ccc;
  transition: .4s;
  border-radius: 34px;
}

.slider:before {
  position: absolute;
  content: "";
  height: 22px;
  width: 22px;
  left: 4px;
  bottom: 4px;
  background-color: white;
  transition: .4s;
  border-radius: 50%;
}

input:checked + .slider {
  background-color: var(--accent);
}

input:checked + .slider:before {
  transform: translateX(30px);
}

/* CUSTOM INPUT HIGHLIGHT */
.custom-active {
  border-color: #00ff88 !important;
  box-shadow: 0 0 15px rgba(0, 255, 136, 0.3) !important;
  background: rgba(0, 40, 20, 0.7) !important;
}

/* SECTION REPLIABLE */
.collapsible {
  cursor: pointer;
  margin-top: 20px;
}

.collapsible-content {
  max-height: 0;
  overflow: hidden;
  transition: max-height 0.3s ease-out;
}

.collapsible-content.expanded {
  max-height: 1000px;
}

.collapsible-icon {
  transition: transform 0.3s;
  display: inline-block;
  margin-right: 10px;
}

.collapsible-icon.rotated {
  transform: rotate(90deg);
}

/* Styles pour le s√©lecteur de couleur */
input[type="color"] {
  border: 2px solid var(--accent);
  border-radius: 8px;
  background: transparent;
  cursor: pointer;
}

input[type="color"]::-webkit-color-swatch-wrapper {
  padding: 0;
}

input[type="color"]::-webkit-color-swatch {
  border: 2px solid rgba(255, 255, 255, 0.3);
  border-radius: 6px;
}

/* Aper√ßu de la couleur HEX */
#colorHex {
  font-family: 'Fira Code', monospace;
  font-weight: bold;
  padding: 2px 6px;
  background: rgba(0, 0, 0, 0.3);
  border-radius: 4px;
  margin-left: 5px;
}

/* Indicateur de densit√© */
.density-low { color: #ff6b6b !important; }
.density-medium { color: #ffa500 !important; }
.density-high { color: #00ff88 !important; }
.density-very-high { color: #ff00ff !important; }
</style>
</head>
<body>
<div class="container">
  <h1>üé≠ G√âN√âRATEUR DE PROMPTS - √âDITION COMPL√àTE</h1>
  <p class="subtitle">Tous les champs personnalisables ‚Ä¢ 75+ personnalit√©s ‚Ä¢ Libert√© cr√©ative totale</p>
  
  <!-- MODE DE G√âN√âRATION -->
  <div class="section">
    <h2 class="section-title">‚öôÔ∏è MODE DE G√âN√âRATION</h2>
    <div class="checkbox-group">
      <div class="checkbox-item">
        <input type="checkbox" id="modeRandom" checked>
        <label for="modeRandom">Mode Al√©atoire Complet</label>
      </div>
      <div class="checkbox-item">
        <input type="checkbox" id="modeAnachronique" checked>
        <label for="modeAnachronique">Anachronismes cr√©atifs</label>
      </div>
      <div class="checkbox-item">
        <input type="checkbox" id="modeHumoristique">
        <label for="modeHumoristique">Humour visuel</label>
      </div>
      <div class="checkbox-item">
        <input type="checkbox" id="modeSurrealiste">
        <label for="modeSurrealiste">Surr√©alisme</label>
      </div>
      <div class="checkbox-item">
        <input type="checkbox" id="showCustomMarkers">
        <label for="showCustomMarkers">Afficher marqueurs personnalis√©s</label>
      </div>
    </div>
  </div>
  
  <!-- GRID PRINCIPAL -->
  <div class="grid-container">
    
    <!-- PERSONNALIT√âS (X) -->
    <div class="section">
      <h2 class="section-title">üé≠ PERSONNALIT√â (X)</h2>
      <div class="personalities-grid" id="personalitiesGrid">
        <!-- Rempli par JavaScript -->
      </div>
      
      <div class="input-group">
        <div class="input-label">S√©lection dans liste :</div>
        <select id="personalitySelect" onchange="selectPersonality(this.value)">
          <option value="">-- Choisir une personnalit√© --</option>
          <!-- Rempli par JavaScript -->
        </select>
        <div class="input-hint">S√©lectionnez une personnalit√© pr√©d√©finie</div>
      </div>
      
      <div class="input-group">
        <div class="input-label">‚ú® Personnalisation libre :</div>
        <input type="text" id="customPersonality" class="custom-input" 
               placeholder="Ex: 'Moi-m√™me', 'Mon personnage original', 'Un alien bienveillant'..."
               oninput="highlightCustomField(this)">
        <div class="input-hint">√âcrivez n'importe quelle personnalit√©. Priorit√© sur la s√©lection ci-dessus.</div>
      </div>
    </div>
    
    <!-- GENRE & FORMAT -->
    <div class="section">
      <h2 class="section-title">üë§ GENRE & FORMAT</h2>
      
      <div class="input-group">
        <div class="input-label">Genre :</div>
        <select id="genre">
          <option value="">Genre non sp√©cifi√©</option>
          <option value="homme">Homme</option>
          <option value="femme">Femme</option>
          <option value="non-binaire">Non-binaire</option>
          <option value="mixte">Mixte</option>
          <option value="autre">Autre</option>
        </select>
      </div>
      
      <div class="input-group">
        <div class="input-label">Format d'image :</div>
        <select id="format">
          <option value="wide shot cin√©matique 16:9">16:9 (Cin√©matique)</option>
          <option value="wide shot ultra-large 21:9">21:9 (Ultra-large)</option>
          <option value="cadrage carr√© 1:1">1:1 (Carr√©)</option>
          <option value="portrait 9:16">9:16 (Portrait)</option>
          <option value="panoramique 3:1">3:1 (Panoramique)</option>
          <option value="IMAX 1.43:1">IMAX (1.43:1)</option>
        </select>
        <div class="input-hint">Format de cadrage pour l'image g√©n√©r√©e</div>
      </div>
      
      <div class="input-group">
        <div class="input-label">√Çge :</div>
        <select id="age">
          <option value="">√Çge non sp√©cifi√©</option>
          <option value="jeune adulte">Jeune adulte</option>
          <option value="adulte">Adulte</option>
          <option value="adulte m√ªr">Adulte m√ªr</option>
          <option value="s√©nior">S√©nior</option>
          <option value="enfant">Enfant</option>
          <option value="adolescent">Adolescent</option>
        </select>
      </div>
      
      <div class="input-group">
        <div class="input-label">√Çge personnalis√© :</div>
        <input type="text" id="customAge" class="custom-input" 
               placeholder="Ex: '250 ans', 'jeune √©ternel', '√¢ge myst√©rieux'..."
               oninput="highlightCustomField(this)">
      </div>
    </div>
    
    <!-- ACTION -->
    <div class="section">
      <h2 class="section-title">üé¨ ACTION PRINCIPALE</h2>
      
      <div class="input-group">
        <div class="input-label">Action pr√©d√©finie :</div>
        <select id="action">
          <option value="">-- Choisir une action --</option>
          <!-- Rempli par JavaScript -->
        </select>
      </div>
      
      <div class="input-group">
        <div class="input-label">‚ú® Action personnalis√©e :</div>
        <input type="text" id="customAction" class="custom-input" 
               placeholder="Ex: 'Code une IA r√©volutionnaire', 'Danse avec des fant√¥mes', 'D√©couvre un tr√©sor perdu'..."
               oninput="highlightCustomField(this)">
        <div class="input-hint">D√©crivez l'action principale de la sc√®ne</div>
      </div>
    </div>
    
    <!-- LIEU -->
    <div class="section">
      <h2 class="section-title">üìç LIEU</h2>
      
      <div class="input-group">
        <div class="input-label">Lieu pr√©d√©fini :</div>
        <select id="lieu">
          <option value="">-- Choisir un lieu --</option>
          <!-- Rempli par JavaScript -->
        </select>
      </div>
      
      <div class="input-group">
        <div class="input-label">‚ú® Lieu personnalis√© :</div>
        <input type="text" id="customLieu" class="custom-input" 
               placeholder="Ex: 'Mon salon', 'Un vaisseau spatial abandonn√©', 'Le royaume des r√™ves'..."
               oninput="highlightCustomField(this)">
        <div class="input-hint">Le d√©cor principal de la sc√®ne</div>
      </div>
    </div>
    
    <!-- √âPOQUE -->
    <div class="section">
      <h2 class="section-title">‚è≥ √âPOQUE / CONTEXTE TEMPOREL</h2>
      
      <div class="input-group">
        <div class="input-label">√âpoque pr√©d√©finie :</div>
        <select id="epoque">
          <option value="">√âpoque non sp√©cifi√©e</option>
          <option value="pr√©historique">Pr√©historique</option>
          <option value="antiquit√© √©gyptienne">Antiquit√© √âgyptienne</option>
          <option value="Gr√®ce antique">Gr√®ce Antique</option>
          <option value="Rome antique">Rome Antique</option>
          <option value="Moyen √Çge">Moyen √Çge</option>
          <option value="Renaissance">Renaissance</option>
          <option value="XVIIe si√®cle">XVIIe Si√®cle</option>
          <option value="XVIIIe si√®cle">XVIIIe Si√®cle</option>
          <option value="√©poque victorienne">√âpoque Victorienne</option>
          <option value="ann√©es folles 1920">Ann√©es Folles 1920</option>
          <option value="ann√©es 1950">Ann√©es 1950</option>
          <option value="ann√©es 1980">Ann√©es 1980</option>
          <option value="ann√©es 2000">Ann√©es 2000</option>
          <option value="futur proche 2030">Futur Proche 2030</option>
          <option value="futur lointain 2500">Futur Lointain 2500</option>
          <option value="√®re cyberpunk 2077">√àre Cyberpunk</option>
          <option value="√®re steampunk">√àre Steampunk</option>
          <option value="√®re post-apocalyptique">√àre Post-Apocalyptique</option>
        </select>
      </div>
      
      <div class="input-group">
        <div class="input-label">‚ú® √âpoque personnalis√©e :</div>
        <input type="text" id="customEpoque" class="custom-input" 
               placeholder="Ex: 'Ann√©e 3024', '√âpoque des dinosaures intelligents', 'D√©but du multivers'..."
               oninput="highlightCustomField(this)">
        <div class="input-hint">Contextualisez temporellement votre sc√®ne</div>
      </div>
    </div>
    
    <!-- COMPAGNONS -->
    <div class="section">
      <h2 class="section-title">üë• COMPAGNONS & PERSONNAGES SECONDAIRES</h2>
      
      <div class="input-group">
        <div class="input-label">Type de compagnon :</div>
        <select id="compagnon">
          <option value="">Aucun compagnon</option>
          <option value="avec foule admirative">Foule admirative</option>
          <option value="avec partenaire">Partenaire</option>
          <option value="avec enfants">Enfants</option>
          <option value="avec amis">Amis</option>
          <option value="avec famille">Famille</option>
          <option value="avec animaux">Animaux</option>
          <option value="avec robots">Robots</option>
          <option value="avec cr√©atures fantastiques">Cr√©atures fantastiques</option>
          <option value="avec public">Public</option>
          <option value="avec disciples">Disciples</option>
          <option value="avec soldats">Soldats</option>
        </select>
      </div>
      
      <div class="input-group">
        <div class="input-label">‚ú® Compagnons personnalis√©s :</div>
        <input type="text" id="customCompagnon" class="custom-input" 
               placeholder="Ex: 'avec ses clones', 'entour√© de fant√¥mes rieurs', 'accompagn√© de drones parlants'..."
               oninput="highlightCustomField(this)">
        <div class="input-hint">Qui accompagne le personnage principal ?</div>
      </div>
    </div>
    
    <!-- RELATIONS & INTERACTIONS -->
    <div class="section">
      <h2 class="section-title">ü§ù RELATIONS & INTERACTIONS</h2>
      
      <div class="input-group">
        <div class="input-label">Type de relation :</div>
        <select id="relationType">
          <option value="">Relation standard (avec)</option>
          <option value="accompagn√© par">Accompagn√© par</option>
          <option value="entour√© de">Entour√© de</option>
          <option value="observ√© par">Observ√© par</option>
          <option value="surveill√© par">Surveill√© par</option>
          <option value="prot√©g√© par">Prot√©g√© par</option>
          <option value="guid√© par">Guid√© par</option>
          <option value="enseign√© par">Enseign√© par</option>
          <option value="combattant contre">Combattant contre</option>
          <option value="d√©fiant">D√©fiant</option>
          <option value="fuyant">Fuyant</option>
          <option value="poursuivant">Poursuivant</option>
          <option value="saluant">Saluant</option>
          <option value="regardant">Regardant</option>
          <option value="tournant le dos √†">Tournant le dos √†</option>
          <option value="donnant √†">Donnant √†</option>
          <option value="recevant de">Recevant de</option>
          <option value="partageant avec">Partageant avec</option>
          <option value="collaborant avec">Collaborant avec</option>
          <option value="dansant avec">Dansant avec</option>
          <option value="chantant avec">Chantant avec</option>
        </select>
        <div class="input-hint">Comment le personnage principal interagit-il avec les autres ?</div>
      </div>
      
      <div class="input-group">
        <div class="input-label">Proximit√© & Position :</div>
        <select id="proximite">
          <option value="">Proximit√© normale</option>
          <option value="tr√®s proche">Tr√®s proche (plan serr√©)</option>
          <option value="√† proximit√©">√Ä proximit√©</option>
          <option value="√† moyenne distance">√Ä moyenne distance</option>
          <option value="en arri√®re-plan">En arri√®re-plan</option>
          <option value="au premier plan">Au premier plan</option>
          <option value="sur les c√¥t√©s">Sur les c√¥t√©s</option>
          <option value="en cercle autour">En cercle autour</option>
          <option value="en formation">En formation</option>
          <option value="dispers√©s">Dispers√©s dans la sc√®ne</option>
        </select>
      </div>
      
      <div class="input-group">
        <div class="input-label">‚ú® Relation personnalis√©e :</div>
        <input type="text" id="customRelation" class="custom-input" 
               placeholder="Ex: 'conspirant avec', 'apprenant de', 'sauv√© par', 'trahi par'..."
               oninput="highlightCustomField(this)">
        <div class="input-hint">D√©crivez une interaction sp√©cifique unique</div>
      </div>
    </div>
    
    <!-- STYLE ARTISTIQUE -->
    <div class="section">
      <h2 class="section-title">üé® STYLE ARTISTIQUE & ESTH√âTIQUE</h2>
      
      <div class="input-group">
        <div class="input-label">Style pr√©d√©fini :</div>
        <select id="style">
          <option value="">-- Choisir un style --</option>
          <!-- Rempli par JavaScript -->
        </select>
      </div>
      
      <div class="input-group">
        <div class="input-label">‚ú® Style personnalis√© :</div>
        <textarea id="customStyle" class="custom-input" rows="3"
                  placeholder="Ex: 'style aquarelle japonaise sumi-e', 'rendu 3D low-poly vintage', 'photographie infrarouge mystique'..."
                  oninput="highlightCustomField(this)"></textarea>
        <div class="input-hint">D√©crivez l'esth√©tique visuelle souhait√©e</div>
      </div>
    </div>
    
    <!-- √âCLAIRAGE & AMBIANCE -->
    <div class="section">
      <h2 class="section-title">üí° √âCLAIRAGE & AMBIANCE LUMINEUSE</h2>
      
      <div class="input-group">
        <div class="input-label">√âclairage pr√©d√©fini :</div>
        <select id="eclairage">
          <option value="">-- Choisir un √©clairage --</option>
          <!-- Rempli par JavaScript -->
        </select>
      </div>
      
      <div class="input-group">
        <div class="input-label">‚ú® √âclairage personnalis√© :</div>
        <input type="text" id="customEclairage" class="custom-input" 
               placeholder="Ex: 'lueur bioluminescente violette', '√©clairage n√©on cyberpunk d√©glingu√©', 'lumi√®re d'apocalypse orange'..."
               oninput="highlightCustomField(this)">
        <div class="input-hint">Atmosph√®re lumineuse de la sc√®ne</div>
      </div>
    </div>
    
    <!-- COSTUME & APPAREANCE -->
    <div class="section">
      <h2 class="section-title">üëî COSTUME, TENUE & APPAREANCE</h2>
      
      <div class="input-group">
        <div class="input-label">Type de costume :</div>
        <select id="costume">
          <option value="">Costume non sp√©cifi√©</option>
          <option value="en tenue de soir√©e">Tenue de soir√©e</option>
          <option value="en costume professionnel">Costume professionnel</option>
          <option value="en tenue d√©contract√©e">Tenue d√©contract√©e</option>
          <option value="en costume historique">Costume historique</option>
          <option value="en tenue futuriste">Tenue futuriste</option>
          <option value="en costume de superh√©ros">Costume de superh√©ros</option>
          <option value="en tenue de sc√®ne">Tenue de sc√®ne</option>
          <option value="en armure">Armure</option>
          <option value="en v√™tements traditionnels">V√™tements traditionnels</option>
          <option value="en tenue de sport">Tenue de sport</option>
        </select>
      </div>
      
      <div class="input-group">
        <div class="input-label">‚ú® Costume personnalis√© :</div>
        <textarea id="customCostume" class="custom-input" rows="3"
                  placeholder="Ex: 'habill√© de lumi√®re pure', 'v√™tu d'un manteau fait de nuages', 'portant une armure de livres anciens'..."
                  oninput="highlightCustomField(this)"></textarea>
        <div class="input-hint">D√©crivez les v√™tements et l'apparence physique</div>
      </div>
    </div>
    
    <!-- √âV√âNEMENT & CONTEXTE -->
    <div class="section">
      <h2 class="section-title">üéâ √âV√âNEMENT / CONTEXTE / SITUATION</h2>
      
      <div class="input-group">
        <div class="input-label">Type d'√©v√©nement :</div>
        <select id="evenement">
          <option value="">Aucun √©v√©nement sp√©cifique</option>
          <option value="concert">Concert</option>
          <option value="c√©r√©monie">C√©r√©monie</option>
          <option value="bataille">Bataille</option>
          <option value="interview">Interview</option>
          <option value="performance">Performance</option>
          <option value="comp√©tition">Comp√©tition</option>
          <option value="f√™te">F√™te</option>
          <option value="voyage">Voyage</option>
          <option value="sauvetage">Sauvetage</option>
          <option value="proc√®s">Proc√®s</option>
          <option value="mariage">Mariage</option>
          <option value="course">Course</option>
          <option value="rituel">Rituel</option>
        </select>
      </div>
      
      <div class="input-group">
        <div class="input-label">‚ú® √âv√©nement personnalis√© :</div>
        <input type="text" id="customEvenement" class="custom-input" 
               placeholder="Ex: 'invasion zombie comique', 'c√©r√©monie de fusion quantique', 'proc√®s intergalactique'..."
               oninput="highlightCustomField(this)">
        <div class="input-hint">Quel est le contexte narratif de la sc√®ne ?</div>
      </div>
    </div>
    
    <!-- D√âTAILS SUPPL√âMENTAIRES -->
    <div class="section">
      <h2 class="section-title">üîç D√âTAILS SUPPL√âMENTAIRES & NOTES</h2>
      
      <div class="input-group">
        <div class="input-label">√âmotions & Expressions :</div>
        <input type="text" id="emotions" 
               placeholder="Ex: 'joie intense', 'concentration extr√™me', 'surprise totale'">
      </div>
      
      <div class="input-group">
        <div class="input-label">‚ú® D√©tails personnalis√©s :</div>
        <textarea id="customDetails" class="custom-input" rows="4"
                  placeholder="Ex: 'Des papillons m√©caniques volent autour', 'Le sol est constitu√© d'eau invers√©e', 'Il y a des statues qui pleurent du chocolat'..."
                  oninput="highlightCustomField(this)"></textarea>
        <div class="input-hint">Ajoutez des √©l√©ments visuels suppl√©mentaires</div>
      </div>
      
      <div class="input-group">
        <div class="input-label">Qualit√© & R√©solution :</div>
        <select id="quality">
          <option value="haute r√©solution">Haute r√©solution</option>
          <option value="ultra-d√©taill√© 8K" selected>Ultra-d√©taill√© 8K</option>
          <option value="photographique 16K">Photographique 16K</option>
          <option value="style croquis">Style croquis</option>
          <option value="rendu 3D">Rendu 3D</option>
        </select>
      </div>
    </div>
    
    <!-- PROMPT N√âGATIF - SECTION REPLIABLE -->
    <div class="section" id="negativePromptSection">
      <h2 class="section-title collapsible" onclick="toggleSection('negativePrompt')">
        <span class="collapsible-icon">‚ñ∂</span> üö´ PROMPT N√âGATIF (AVANC√â)
      </h2>
      
      <div class="collapsible-content" id="negativePromptContent">
        <div class="input-group">
          <div class="input-label">Prompt n√©gatif en fran√ßais :</div>
          <textarea id="negativePrompt" rows="8" style="font-family: 'Fira Code', monospace; font-size: 14px;">
mains mal dessin√©es, pieds mal dessin√©s, visage mal dessin√©, mauvaise anatomie, membres suppl√©mentaires, membres manquants, d√©figur√©, d√©form√©, flou, mauvaises proportions, doigts suppl√©mentaires, moins de doigts, doigts fusionn√©s, mains mut√©es, membres flottants, membres d√©connect√©s, hors cadre, recadr√©, basse qualit√©, pire qualit√©, artefacts jpeg, filigrane, signature, nom d'utilisateur, texte, logo, dupliqu√©, distordu, pixellis√©, basse r√©solution, surexpos√©, sous-expos√©, mauvais √©clairage, √©clairage plat, mauvaise composition, mauvais cadrage, mauvaise perspective, inclin√©, d√©s√©quilibr√©, mauvaise profondeur de champ, d√©coupage, g√©om√©trie qui se croise, objets flottants, ombres incorrectes, ombres manquantes, √©clairage incoh√©rent, bruit, grain, sursatur√©, sous-satur√©, aberration chromatique, artefacts, glitchs, erreurs anatomiques, pose non naturelle, pose raide, yeux asym√©triques, mal rendu, manque de d√©tails, trop liss√©, sur-accentu√©, texte mal orthographi√©, fautes d'orthographe, fautes de frappe, erreurs grammaticales, lettres incorrectes, texte illisible, charabia, texte absurde, texte brouill√©, texte non lisible, texte mal √©crit, orthographe incorrecte, lettres mal form√©es, texte d√©form√©, texte flou, texte pixellis√©, texte cass√©, texte fragment√©, texte √† l'envers, texte invers√©, mauvaise police, police incoh√©rente, polices m√©lang√©es
          </textarea>
          <div class="input-hint">Ce prompt n√©gatif sera ajout√© automatiquement √† votre prompt g√©n√©r√©. Vous pouvez le modifier selon vos besoins.</div>
        </div>
        
        <div class="checkbox-group">
          <div class="checkbox-item">
            <input type="checkbox" id="includeNegativePrompt" checked>
            <label for="includeNegativePrompt">Inclure le prompt n√©gatif</label>
          </div>
          <div class="checkbox-item">
            <input type="checkbox" id="autoCopyNegative">
            <label for="autoCopyNegative">Copier automatiquement avec le prompt</label>
          </div>
          <div class="checkbox-item">
            <input type="checkbox" id="showEnglishNegative">
            <label for="showEnglishNegative">Afficher aussi la version anglaise</label>
          </div>
        </div>
        
        <div class="input-group" id="englishNegativeContainer" style="display: none;">
          <div class="input-label">Prompt n√©gatif en anglais :</div>
          <textarea id="negativePromptEnglish" rows="8" style="font-family: 'Fira Code', monospace; font-size: 14px;">
poorly drawn hands, poorly drawn feet, poorly drawn face, bad anatomy, extra limbs, missing limbs, disfigured, deformed, blurry, bad proportions, extra fingers, fewer fingers, fused fingers, mutated hands, floating limbs, disconnected limbs, out of frame, cropped, low quality, worst quality, jpeg artifacts, watermark, signature, username, text, logo, duplicate, distorted, pixelated, low resolution, overexposed, underexposed, bad lighting, flat lighting, bad composition, bad framing, bad perspective, tilted, unbalanced, bad depth of field, clipping, intersecting geometry, floating objects, wrong shadows, missing shadows, inconsistent lighting, noise, grain, oversaturated, undersaturated, chromatic aberration, artefacts, glitches, anatomical errors, unnatural pose, stiff pose, asymmetric eyes, poorly rendered, lack of detail, oversmoothed, oversharpened, misspelled text, spelling errors, typos, grammatical errors, wrong letters, illegible text, gibberish text, nonsense text, garbled text, unreadable text, badly written text, incorrect spelling, malformed letters, distorted text, blurry text, pixelated text, broken text, fragmented text, backwards text, upside down text, wrong font, inconsistent font, mixed fonts
          </textarea>
          <div class="input-hint">Certains moteurs d'IA r√©agissent mieux aux prompts n√©gatifs en anglais. Utilisez la version qui correspond √† la langue de votre prompt principal.</div>
        </div>
      </div>
    </div>
    
    <!-- TEXTE SUR L'IMAGE - SECTION REPLIABLE -->
    <div class="section" id="textOnImageSection">
      <h2 class="section-title collapsible" onclick="toggleSection('textOnImage')">
        <span class="collapsible-icon">‚ñ∂</span> üìù TEXTE SUR L'IMAGE (OPTIONNEL)
      </h2>
      
      <div class="collapsible-content" id="textOnImageContent">
        <div class="input-group">
          <div class="input-label">Texte √† afficher sur l'image :</div>
          <textarea id="imageText" rows="3" placeholder="Ex: 'Bienvenue au futur', '√âv√©nement sp√©cial 2024', 'Carpe Diem'..."></textarea>
          <div class="input-hint">Le texte qui appara√Ætra directement sur l'image g√©n√©r√©e</div>
        </div>
        
        <div class="grid-container" style="grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); margin: 20px 0;">
          
          <div class="input-group">
            <div class="input-label">Style d'√©criture :</div>
            <select id="textStyle">
              <option value="">Style standard</option>
              <option value="en graffiti">Graffiti urbain</option>
              <option value="en calligraphie">Calligraphie √©l√©gante</option>
              <option value="en typographie moderne">Typographie moderne</option>
              <option value="en √©criture manuscrite">√âcriture manuscrite</option>
              <option value="en n√©on">N√©on lumineux</option>
              <option value="en style vintage">Style vintage</option>
              <option value="en pixel art">Pixel art</option>
              <option value="en m√©tal">Effet m√©tal</option>
              <option value="en verre">Effet verre</option>
              <option value="en feu">Effet feu</option>
              <option value="en glace">Effet glace</option>
            </select>
          </div>
          
          <div class="input-group">
            <div class="input-label">Couleur du texte :</div>
            <div style="display: flex; gap: 10px; align-items: center;">
              <input type="color" id="textColor" value="#ffffff" style="width: 50px; height: 50px; cursor: pointer;">
              <select id="textColorName" style="flex: 1;" onchange="updateColorPicker(this)">
                <option value="#ffffff">Blanc</option>
                <option value="#000000">Noir</option>
                <option value="#ff0000">Rouge</option>
                <option value="#00ff00">Vert</option>
                <option value="#0000ff">Bleu</option>
                <option value="#ffff00">Jaune</option>
                <option value="#ff00ff">Magenta</option>
                <option value="#00ffff">Cyan</option>
                <option value="#ff6b6b">Rouge clair</option>
                <option value="#00d4ff">Bleu clair</option>
                <option value="#9d4edd">Violet</option>
                <option value="#4ecdc4">Turquoise</option>
                <option value="#ffa500">Orange</option>
                <option value="#800080">Pourpre</option>
                <option value="#ff1493">Rose vif</option>
                <option value="#32cd32">Vert lime</option>
                <option value="#custom">Personnalis√© (HEX)</option>
              </select>
            </div>
            <div class="input-hint">Couleur du texte : <span id="colorHex">#ffffff</span></div>
          </div>
          
          <div class="input-group">
            <div class="input-label">Position du texte :</div>
            <select id="textPosition">
              <option value="centr√©">Centr√©</option>
              <option value="en haut">En haut</option>
              <option value="en bas">En bas</option>
              <option value="en haut √† gauche">En haut √† gauche</option>
              <option value="en haut √† droite">En haut √† droite</option>
              <option value="en bas √† gauche">En bas √† gauche</option>
              <option value="en bas √† droite">En bas √† droite</option>
              <option value="sur le c√¥t√© gauche">Sur le c√¥t√© gauche</option>
              <option value="sur le c√¥t√© droit">Sur le c√¥t√© droit</option>
              <option value="au centre gauche">Au centre gauche</option>
              <option value="au centre droit">Au centre droit</option>
            </select>
          </div>
          
          <div class="input-group">
            <div class="input-label">Taille du texte :</div>
            <select id="textSize">
              <option value="petit">Petit</option>
              <option value="moyen" selected>Moyen</option>
              <option value="grand">Grand</option>
              <option value="tr√®s grand">Tr√®s grand</option>
              <option value="g√©ant">G√©ant</option>
              <option value="discret">Discret</option>
            </select>
          </div>
          
        </div>
        
        <div class="checkbox-group">
          <div class="checkbox-item">
            <input type="checkbox" id="includeTextInPrompt" checked>
            <label for="includeTextInPrompt">Inclure le texte dans le prompt</label>
          </div>
          <div class="checkbox-item">
            <input type="checkbox" id="textWithBackground">
            <label for="textWithBackground">Ajouter un arri√®re-plan au texte</label>
          </div>
          <div class="checkbox-item">
            <input type="checkbox" id="textTransparent">
            <label for="textTransparent">Texte semi-transparent</label>
          </div>
        </div>
        
        <div class="input-group">
          <div class="input-label">‚ú® D√©tails suppl√©mentaires pour le texte :</div>
          <input type="text" id="textDetails" placeholder="Ex: 'avec ombre port√©e', 'entour√© d\'un halo lumineux', 'avec reflet dans l\'eau'...">
        </div>
      </div>
    </div>
    
  </div> <!-- Fin grid-container -->
  
  <!-- CONTROLS -->
  <div class="controls">
    <div class="control-group">
      <input type="checkbox" id="autoCopy" checked>
      <label for="autoCopy">Copie auto apr√®s g√©n√©ration</label>
    </div>
    
    <div class="control-group">
      <span>Prompt #<span id="promptCount">0</span></span>
    </div>
    
    <div class="control-group">
      <select id="complexity">
        <option value="simple">Simple</option>
        <option value="normal" selected>Normal</option>
        <option value="detaille">D√©taill√©</option>
        <option value="ultra">Ultra-d√©taill√©</option>
      </select>
      <label>Complexit√©</label>
    </div>
    
    <div class="control-group">
      <label class="switch">
        <input type="checkbox" id="toggleCustom" checked>
        <span class="slider"></span>
      </label>
      <label for="toggleCustom">Priorit√© aux champs personnalis√©s</label>
    </div>
  </div>
  
  <!-- BOUTONS PRINCIPAUX -->
  <div class="button-group">
    <button id="generateBtn" onclick="generatePrompt()">
      <span>üöÄ</span> G√âN√âRER LE PROMPT
    </button>
    
    <button id="randomAllBtn" onclick="randomizeAll()">
      <span>üé≤</span> RANDOM COMPLET
    </button>
    
    <button id="copyBtn" onclick="copyPrompt()">
      <span>üìã</span> COPIER LE PROMPT
    </button>
    
    <button id="clearBtn" onclick="clearAll()">
      <span>üóëÔ∏è</span> TOUT EFFACER
    </button>
    
    <button id="exampleBtn" onclick="generateExample()">
      <span>‚ú®</span> EXEMPLE CR√âATIF
    </button>
  </div>
  
  <!-- CHARGEMENT -->
  <div class="loading" id="loading">
    <span></span>
    <span></span>
    <span></span>
  </div>
  
  <!-- PROMPT OUTPUT -->
  <div class="prompt-container">
    <h2 class="section-title">üìù PROMPT G√âN√âR√â</h2>
    <div style="margin-bottom: 15px; font-size: 0.9em; color: #88ccff;">
      <span id="customFieldsCount">0</span> champ(s) personnalis√©(s) utilis√©s
      <span id="selectedFieldsCount" style="margin-left: 20px;">0</span> champ(s) s√©lectionn√©(s)
      <span id="densityIndicator" style="margin-left: 20px; display: none;">
        ‚Ä¢ Densit√©: <span id="densityValue">0</span>%
      </span>
    </div>
    
    <!-- Indicateur visuel de densit√© -->
    <div id="densityBar" style="height: 6px; background: rgba(0, 212, 255, 0.2); border-radius: 3px; margin-bottom: 15px; overflow: hidden;">
      <div id="densityFill" style="height: 100%; width: 0%; background: linear-gradient(90deg, #00d4ff, #00ff88); border-radius: 3px; transition: width 0.5s;"></div>
    </div>
    
    <textarea id="promptOutput" readonly placeholder="Votre prompt appara√Ætra ici..."></textarea>
  </div>
  
</div>

<!-- COMPTEUR -->
<div class="counter" id="counter" title="Nombre de prompts g√©n√©r√©s">0</div>

<script>
// DONN√âES - LISTES COMPL√àTES
const data = {
  // 75 PERSONNALIT√âS MARQUANTES
  personalities: [
    // CHANTEURS (15)
    {name: "Freddie Mercury", category: "Chanteur"},
    {name: "Beyonc√©", category: "Chanteuse"},
    {name: "Michael Jackson", category: "Chanteur"},
    {name: "David Bowie", category: "Chanteur"},
    {name: "Madonna", category: "Chanteuse"},
    {name: "Elvis Presley", category: "Chanteur"},
    {name: "Lady Gaga", category: "Chanteuse"},
    {name: "Bob Marley", category: "Chanteur"},
    {name: "Amy Winehouse", category: "Chanteuse"},
    {name: "Elton John", category: "Chanteur"},
    {name: "Adele", category: "Chanteuse"},
    {name: "Prince", category: "Chanteur"},
    {name: "Taylor Swift", category: "Chanteuse"},
    {name: "Frank Sinatra", category: "Chanteur"},
    {name: "Shakira", category: "Chanteuse"},
    
    // ACTEURS (15)
    {name: "Marilyn Monroe", category: "Actrice"},
    {name: "Leonardo DiCaprio", category: "Acteur"},
    {name: "Meryl Streep", category: "Actrice"},
    {name: "Brad Pitt", category: "Acteur"},
    {name: "Audrey Hepburn", category: "Actrice"},
    {name: "Robert De Niro", category: "Acteur"},
    {name: "Scarlett Johansson", category: "Actrice"},
    {name: "Tom Hanks", category: "Acteur"},
    {name: "Angelina Jolie", category: "Actrice"},
    {name: "Johnny Depp", category: "Acteur"},
    {name: "Emma Watson", category: "Actrice"},
    {name: "Denzel Washington", category: "Acteur"},
    {name: "Natalie Portman", category: "Actrice"},
    {name: "Keanu Reeves", category: "Acteur"},
    {name: "Jennifer Lawrence", category: "Actrice"},
    
    // SPORTIFS (15)
    {name: "Michael Jordan", category: "Sportif"},
    {name: "Serena Williams", category: "Sportive"},
    {name: "Cristiano Ronaldo", category: "Sportif"},
    {name: "Simone Biles", category: "Sportive"},
    {name: "LeBron James", category: "Sportif"},
    {name: "Megan Rapinoe", category: "Sportive"},
    {name: "Lionel Messi", category: "Sportif"},
    {name: "Naomi Osaka", category: "Sportive"},
    {name: "Usain Bolt", category: "Sportif"},
    {name: "Rafael Nadal", category: "Sportif"},
    {name: "Katie Ledecky", category: "Sportive"},
    {name: "Tom Brady", category: "Sportif"},
    {name: "Simone Manuel", category: "Sportive"},
    {name: "Stephen Curry", category: "Sportif"},
    {name: "Alex Morgan", category: "Sportive"},
    
    // SUPERH√âROS (10)
    {name: "Superman", category: "Superh√©ros"},
    {name: "Wonder Woman", category: "Superh√©ro√Øne"},
    {name: "Batman", category: "Superh√©ros"},
    {name: "Spider-Man", category: "Superh√©ros"},
    {name: "Black Panther", category: "Superh√©ros"},
    {name: "Captain America", category: "Superh√©ros"},
    {name: "Iron Man", category: "Superh√©ros"},
    {name: "Catwoman", category: "Superh√©ro√Øne"},
    {name: "The Flash", category: "Superh√©ros"},
    {name: "Storm", category: "Superh√©ro√Øne"},
    
    // CR√âATURES FANTASTIQUES (10)
    {name: "Un dragon", category: "Cr√©ature"},
    {name: "Une licorne", category: "Cr√©ature"},
    {name: "Un vampire", category: "Cr√©ature"},
    {name: "Un loup-garou", category: "Cr√©ature"},
    {name: "Un fant√¥me", category: "Cr√©ature"},
    {name: "Un alien", category: "Cr√©ature"},
    {name: "Un zombie", category: "Cr√©ature"},
    {name: "Un d√©mon", category: "Cr√©ature"},
    {name: "Un ange", category: "Cr√©ature"},
    {name: "Un robot", category: "Cr√©ature"},
    
    // H√âROS DESSINS ANIM√âS (10)
    {name: "Mickey Mouse", category: "Dessin anim√©"},
    {name: "Bugs Bunny", category: "Dessin anim√©"},
    {name: "SpongeBob", category: "Dessin anim√©"},
    {name: "Sonic", category: "Dessin anim√©"},
    {name: "Pikachu", category: "Dessin anim√©"},
    {name: "Homer Simpson", category: "Dessin anim√©"},
    {name: "Scooby-Doo", category: "Dessin anim√©"},
    {name: "Winnie l'Ourson", category: "Dessin anim√©"},
    {name: "Dora l'Exploratrice", category: "Dessin anim√©"},
    {name: "Rick Sanchez", category: "Dessin anim√©"}
  ],
  
  // ACTIONS (extraites des prompts)
  actions: [
    "chante sur sc√®ne", "danse fr√©n√©tiquement", "combat h√©ro√Øquement", "parle en public", 
    "court √† toute vitesse", "vole dans les airs", "nage gracieusement", "joue de la musique",
    "peint un chef-d'≈ìuvre", "√©crit passionn√©ment", "cuisine avec talent", "explore un nouveau monde",
    "enseigne √† des √©l√®ves", "dirige une √©quipe", "m√©dite profond√©ment", "rit aux √©clats",
    "pleure d'√©motion", "observe attentivement", "construit activement", "d√©truit violemment",
    "sauve des vies", "vole un objet", "triche au jeu", "gagne une comp√©tition",
    "perd tragiquement", "tombe amoureux", "se bat en duel", "n√©gocie habilement",
    "d√©couvre un secret", "cache un tr√©sor", "transforme magiquement", "t√©l√©porte soudainement",
    "grandit d√©mesur√©ment", "r√©tr√©cit bizarrement", "dispara√Æt myst√©rieusement", "r√©appara√Æt spectaculairement"
  ],
  
  // LIEUX (extraites des prompts)
  lieux: [
    "Times Square New York", "Tour Eiffel Paris", "Colis√©e Rome", "Grande Muraille Chine",
    "Pyramides de Gizeh", "Machu Picchu P√©rou", "Venise canaux", "Plage Copacabana Rio",
    "Mont Saint-Michel", "Ch√¢teau de Versailles", "Shibuya Crossing Tokyo", "Op√©ra Sydney",
    "Grand Canyon Arizona", "Chutes Niagara", "Taj Mahal Inde", "Notre-Dame Paris",
    "Station Spatiale ISS", "Ville sous-marine Atlantis", "For√™t enchant√©e", "Ch√¢teau nuages",
    "Ville cyberpunk n√©ons", "Base lunaire", "Vaisseau spatial", "Dimension parall√®le",
    "Biblioth√®que infinie", "Jardin des d√©lices", "Laboratoire secret", "Temple ancien",
    "Volcan actif", "Fond marin", "D√©sert Sahara", "Jungle Amazonie",
    "M√©tro Parisien", "Supermarch√© local", "Caf√© terrasse", "Biblioth√®que municipale",
    "Salle de classe", "Gare SNCF", "Centre commercial", "Parc public"
  ],
  
  // STYLES ARTISTIQUES
  styles: [
    "r√©aliste photographique", "hyperr√©aliste 8K", "photo magazine glossy", 
    "noir et blanc contrast√©", "s√©pia vintage", "couleurs satur√©es pop",
    "cin√©matique √©pique", "film Hollywood", "film noir 1940s", "film Wes Anderson",
    "film Tim Burton", "animation Disney", "anime japonais", "style Ghibli",
    "cartoon Pixar", "BD franco-belge", "manga", "peinture √† l'huile",
    "aquarelle douce", "croquis crayon", "encre de Chine", "pastels tendres",
    "impressionniste Monet", "cubiste Picasso", "surr√©aliste Dal√≠", "pop art Warhol",
    "art nouveau Mucha", "art d√©co", "cyberpunk n√©on", "steampunk",
    "vaporwave 80s", "pixel art 8-bit", "low poly", "graffiti urbain",
    "glitch art", "fractal art", "minimaliste japonais", "flat design"
  ],
  
  // √âCLAIRAGES & AMBIANCES
  eclairages: [
    "soleil couchant dor√©", "aurore ros√©e douce", "midi soleil √©clatant",
    "lune pleine argent√©e", "ciel √©toil√© voie lact√©e", "aurore bor√©ale verte",
    "n√©ons bleu orange futuriste", "feux d'artifice multicolore", "bougies chaleureuses",
    "lasers discoth√®que", "lumi√®res noires UV", "√©clairage fluorescent",
    "LED RGB color√©es", "brume matinale", "√©clair orage", "arc-en-ciel",
    "teintes pastel douces", "monochrome s√©pia", "gradient violet-orange",
    "palette terre naturelle", "effet cin√©matique teal/orange", "contraste √©lev√© dramatique",
    "clair-obscur", "ombres profondes", "luminescence douce", "pluie r√©fl√©chissante n√©on",
    "brouillard mystique", "neige tombante", "poussi√®re d'√©toiles", "particules lumineuses"
  ]
};

// VARIABLES GLOBALES
let promptCount = 0;
let selectedPersonality = null;

// INITIALISATION
document.addEventListener('DOMContentLoaded', function() {
  // Remplir les personnalit√©s
  const grid = document.getElementById('personalitiesGrid');
  const select = document.getElementById('personalitySelect');
  
  data.personalities.forEach((person, index) => {
    // Carte dans la grille
    const card = document.createElement('div');
    card.className = 'personality-card';
    card.dataset.id = index;
    card.innerHTML = `
      <strong>${person.name}</strong>
      <div class="personality-category">${person.category}</div>
    `;
    card.onclick = () => selectPersonalityCard(index);
    grid.appendChild(card);
    
    // Option dans le select
    const option = document.createElement('option');
    option.value = index;
    option.textContent = `${person.name} (${person.category})`;
    select.appendChild(option);
  });
  
  // Remplir les actions
  const actionSelect = document.getElementById('action');
  data.actions.forEach(action => {
    const option = document.createElement('option');
    option.value = action;
    option.textContent = action;
    actionSelect.appendChild(option);
  });
  
  // Remplir les lieux
  const lieuSelect = document.getElementById('lieu');
  data.lieux.forEach(lieu => {
    const option = document.createElement('option');
    option.value = lieu;
    option.textContent = lieu;
    lieuSelect.appendChild(option);
  });
  
  // Remplir les styles
  const styleSelect = document.getElementById('style');
  data.styles.forEach(style => {
    const option = document.createElement('option');
    option.value = style;
    option.textContent = style;
    styleSelect.appendChild(option);
  });
  
  // Remplir les √©clairages
  const eclairageSelect = document.getElementById('eclairage');
  data.eclairages.forEach(eclairage => {
    const option = document.createElement('option');
    option.value = eclairage;
    option.textContent = eclairage;
    eclairageSelect.appendChild(option);
  });
  
  // Activer/d√©sactiver l'effet des champs personnalis√©s
  document.getElementById('toggleCustom').addEventListener('change', function() {
    const status = this.checked ? "activ√©e" : "d√©sactiv√©e";
    showNotification(`Priorit√© aux champs personnalis√©s ${status}`, this.checked ? '#00ff88' : '#ff6b6b');
  });
  
  // Gestion de l'affichage de la version anglaise du prompt n√©gatif
  document.getElementById('showEnglishNegative').addEventListener('change', function() {
    const container = document.getElementById('englishNegativeContainer');
    container.style.display = this.checked ? 'block' : 'none';
  });
  
  // Gestion du s√©lecteur de couleur pour le texte
  document.getElementById('textColor').addEventListener('input', function() {
    const colorHexSpan = document.getElementById('colorHex');
    const select = document.getElementById('textColorName');
    
    const hexColor = this.value;
    colorHexSpan.textContent = hexColor;
    colorHexSpan.style.color = hexColor;
    
    // Trouver si cette couleur existe dans les options
    let found = false;
    for (let option of select.options) {
      if (option.value === hexColor) {
        select.value = hexColor;
        found = true;
        break;
      }
    }
    
    if (!found) {
      select.value = 'custom';
    }
  });
  
  // G√©n√©rer un premier prompt d'exemple
  setTimeout(() => {
    generateExample();
  }, 1000);
});

// FONCTIONS UTILITAIRES
function highlightCustomField(element) {
  if (element.value.trim()) {
    element.classList.add('custom-active');
  } else {
    element.classList.remove('custom-active');
  }
  updateCounters();
}

function showNotification(message, color = '#00d4ff') {
  // Cr√©er une notification temporaire
  const notification = document.createElement('div');
  notification.textContent = message;
  notification.style.cssText = `
    position: fixed;
    top: 20px;
    right: 20px;
    background: ${color};
    color: ${color === '#00ff88' ? '#000' : 'white'};
    padding: 15px 25px;
    border-radius: 10px;
    z-index: 10000;
    box-shadow: 0 5px 20px rgba(0,0,0,0.3);
    animation: slideIn 0.3s ease-out;
  `;
  
  document.body.appendChild(notification);
  
  setTimeout(() => {
    notification.style.animation = 'slideOut 0.3s ease-out';
    setTimeout(() => notification.remove(), 300);
  }, 3000);
}

function updateCounters() {
  // Compter les champs personnalis√©s remplis
  const customFields = document.querySelectorAll('.custom-input');
  let customCount = 0;
  customFields.forEach(field => {
    if (field.value.trim()) customCount++;
  });
  
  // Compter les s√©lections non-vides
  const selects = document.querySelectorAll('select');
  let selectedCount = 0;
  selects.forEach(select => {
    if (select.value && select.id !== 'personalitySelect') selectedCount++; // Exclure personalitySelect car doublon
  });
  
  document.getElementById('customFieldsCount').textContent = customCount;
  document.getElementById('selectedFieldsCount').textContent = selectedCount;
}

function selectPersonalityCard(index) {
  // Retirer la s√©lection pr√©c√©dente
  document.querySelectorAll('.personality-card').forEach(card => {
    card.classList.remove('selected');
  });
  
  // Ajouter la nouvelle s√©lection
  const card = document.querySelector(`.personality-card[data-id="${index}"]`);
  if (card) {
    card.classList.add('selected');
  }
  
  // Mettre √† jour le select
  document.getElementById('personalitySelect').value = index;
  selectedPersonality = data.personalities[index];
  
  // D√©sactiver le champ personnalis√© s'il √©tait utilis√©
  document.getElementById('customPersonality').value = '';
  highlightCustomField(document.getElementById('customPersonality'));
  
  updateCounters();
}

function selectPersonality(value) {
  if (value === "") {
    // Retirer la s√©lection
    document.querySelectorAll('.personality-card').forEach(card => {
      card.classList.remove('selected');
    });
    selectedPersonality = null;
    return;
  }
  
  selectPersonalityCard(parseInt(value));
}

function getRandomItem(array) {
  return array[Math.floor(Math.random() * array.length)];
}

// Fonction pour replier/d√©plier les sections
function toggleSection(sectionId) {
  const content = document.getElementById(sectionId + 'Content');
  const icon = content.previousElementSibling.querySelector('.collapsible-icon');
  
  content.classList.toggle('expanded');
  icon.classList.toggle('rotated');
}

// Fonction pour mettre √† jour le s√©lecteur de couleur
function updateColorPicker(select) {
  const colorPicker = document.getElementById('textColor');
  const colorHexSpan = document.getElementById('colorHex');
  
  if (select.value === 'custom') {
    // Ouvrir le s√©lecteur de couleur personnalis√©
    colorPicker.click();
  } else {
    colorPicker.value = select.value;
    colorHexSpan.textContent = select.value;
    colorHexSpan.style.color = select.value;
  }
}

// Fonction pour calculer la densit√© du prompt
function calculatePromptDensity(promptText) {
  if (!promptText) return { density: 0, level: 'empty' };
  
  // Nettoyer le prompt
  const cleanPrompt = promptText.replace(/^#\d+\s*/, '');
  
  // Compter les √©l√©ments
  const elements = cleanPrompt.split(',').length;
  const words = cleanPrompt.split(/\s+/).length;
  const characters = cleanPrompt.length;
  
  // Calcul de densit√© (poids des √©l√©ments)
  let densityScore = 0;
  
  // Points pour le nombre d'√©l√©ments
  if (elements > 15) densityScore += 40;
  else if (elements > 10) densityScore += 30;
  else if (elements > 5) densityScore += 20;
  else if (elements > 2) densityScore += 10;
  
  // Points pour la longueur
  if (words > 100) densityScore += 40;
  else if (words > 70) densityScore += 30;
  else if (words > 50) densityScore += 20;
  else if (words > 30) densityScore += 10;
  
  // Points pour les d√©tails sp√©ciaux
  if (cleanPrompt.includes(':')) densityScore += 10;
  if (cleanPrompt.includes('(') || cleanPrompt.includes(')')) densityScore += 5;
  if (cleanPrompt.includes('--')) densityScore += 5;
  
  // Limiter √† 100%
  densityScore = Math.min(100, densityScore);
  
  // D√©terminer le niveau
  let level;
  if (densityScore < 20) level = 'low';
  else if (densityScore < 40) level = 'medium';
  else if (densityScore < 70) level = 'high';
  else level = 'very-high';
  
  return {
    density: densityScore,
    level: level,
    elements: elements,
    words: words,
    characters: characters
  };
}

// Fonction pour mettre √† jour l'indicateur de densit√©
function updateDensityIndicator(promptText) {
  const densityInfo = calculatePromptDensity(promptText);
  const densityValue = document.getElementById('densityValue');
  const densityFill = document.getElementById('densityFill');
  const densityIndicator = document.getElementById('densityIndicator');
  
  if (densityInfo.density === 0) {
    densityIndicator.style.display = 'none';
    return;
  }
  
  // Afficher l'indicateur
  densityIndicator.style.display = 'inline';
  densityValue.textContent = densityInfo.density;
  densityFill.style.width = `${densityInfo.density}%`;
  
  // Changer la couleur selon le niveau
  densityValue.className = `density-${densityInfo.level}`;
  
  // Changer la couleur de la barre
  let gradient;
  switch(densityInfo.level) {
    case 'low':
      gradient = 'linear-gradient(90deg, #ff6b6b, #ff8e8e)';
      break;
    case 'medium':
      gradient = 'linear-gradient(90deg, #ffa500, #ffcc00)';
      break;
    case 'high':
      gradient = 'linear-gradient(90deg, #00d4ff, #00ff88)';
      break;
    case 'very-high':
      gradient = 'linear-gradient(90deg, #9d4edd, #ff00ff)';
      break;
    default:
      gradient = 'linear-gradient(90deg, #00d4ff, #00ff88)';
  }
  
  densityFill.style.background = gradient;
}

// Fonction pour obtenir le prompt n√©gatif complet
function getNegativePrompt() {
  let negativePrompt = '';
  
  if (document.getElementById('includeNegativePrompt').checked) {
    // Version fran√ßaise
    negativePrompt = document.getElementById('negativePrompt').value.trim();
    
    // Ajouter la version anglaise si coch√©e
    if (document.getElementById('showEnglishNegative').checked) {
      const englishNegative = document.getElementById('negativePromptEnglish').value.trim();
      if (englishNegative) {
        negativePrompt += ', ' + englishNegative;
      }
    }
  }
  
  return negativePrompt;
}

// Fonction pour obtenir la description du texte sur l'image
function getImageTextDescription() {
  const text = document.getElementById('imageText').value.trim();
  if (!text || !document.getElementById('includeTextInPrompt').checked) {
    return '';
  }
  
  let description = `avec le texte "${text}"`;
  
  // Style d'√©criture
  const style = document.getElementById('textStyle').value;
  if (style) {
    description += ` ${style}`;
  }
  
  // Couleur
  const colorName = document.getElementById('textColorName');
  const color = colorName.options[colorName.selectedIndex].text;
  if (color && color !== 'Personnalis√© (HEX)') {
    description += ` en ${color.toLowerCase()}`;
  }
  
  // Position
  const position = document.getElementById('textPosition').value;
  if (position) {
    description += `, positionn√© ${position}`;
  }
  
  // Taille
  const size = document.getElementById('textSize').value;
  if (size) {
    description += `, taille ${size}`;
  }
  
  // Options suppl√©mentaires
  const options = [];
  if (document.getElementById('textWithBackground').checked) {
    options.push('avec arri√®re-plan');
  }
  if (document.getElementById('textTransparent').checked) {
    options.push('semi-transparent');
  }
  
  // D√©tails suppl√©mentaires
  const details = document.getElementById('textDetails').value.trim();
  if (details) {
    options.push(details);
  }
  
  if (options.length > 0) {
    description += `, ${options.join(', ')}`;
  }
  
  return description;
}

function randomizeAll() {
  // Personnalit√© al√©atoire
  const personalityIndex = Math.floor(Math.random() * data.personalities.length);
  selectPersonalityCard(personalityIndex);
  
  // Genre al√©atoire
  const genres = ["", "homme", "femme", "non-binaire", "mixte", "autre"];
  document.getElementById('genre').value = getRandomItem(genres);
  
  // Format al√©atoire
  const formats = document.getElementById('format').options;
  document.getElementById('format').selectedIndex = Math.floor(Math.random() * formats.length);
  
  // √Çge al√©atoire
  const ages = document.getElementById('age').options;
  document.getElementById('age').selectedIndex = Math.floor(Math.random() * ages.length);
  
  // Action al√©atoire
  const actionIndex = Math.floor(Math.random() * data.actions.length);
  document.getElementById('action').selectedIndex = actionIndex + 1; // +1 pour l'option vide
  
  // Lieu al√©atoire
  const lieuIndex = Math.floor(Math.random() * data.lieux.length);
  document.getElementById('lieu').selectedIndex = lieuIndex + 1;
  
  // √âpoque al√©atoire
  const epoqueOptions = document.getElementById('epoque').options;
  document.getElementById('epoque').selectedIndex = Math.floor(Math.random() * epoqueOptions.length);
  
  // Compagnon al√©atoire
  const compagnonOptions = document.getElementById('compagnon').options;
  document.getElementById('compagnon').selectedIndex = Math.floor(Math.random() * compagnonOptions.length);
  
  // Relation al√©atoire
  const relationOptions = document.getElementById('relationType').options;
  document.getElementById('relationType').selectedIndex = Math.floor(Math.random() * relationOptions.length);
  
  // Proximit√© al√©atoire
  const proximiteOptions = document.getElementById('proximite').options;
  document.getElementById('proximite').selectedIndex = Math.floor(Math.random() * proximiteOptions.length);
  
  // Style al√©atoire
  const styleIndex = Math.floor(Math.random() * data.styles.length);
  document.getElementById('style').selectedIndex = styleIndex + 1;
  
  // √âclairage al√©atoire
  const eclairageIndex = Math.floor(Math.random() * data.eclairages.length);
  document.getElementById('eclairage').selectedIndex = eclairageIndex + 1;
  
  // Costume al√©atoire
  const costumeOptions = document.getElementById('costume').options;
  document.getElementById('costume').selectedIndex = Math.floor(Math.random() * costumeOptions.length);
  
  // √âv√©nement al√©atoire
  const evenementOptions = document.getElementById('evenement').options;
  document.getElementById('evenement').selectedIndex = Math.floor(Math.random() * evenementOptions.length);
  
  // √âmotions al√©atoires
  const emotions = ["joie intense", "col√®re froide", "surprise totale", "tristesse profonde", "peur panique", "extase"];
  document.getElementById('emotions').value = Math.random() > 0.5 ? getRandomItem(emotions) : "";
  
  // Qualit√© al√©atoire
  const qualities = document.getElementById('quality').options;
  document.getElementById('quality').selectedIndex = Math.floor(Math.random() * qualities.length);
  
  // Complexit√© al√©atoire
  const complexities = ["simple", "normal", "detaille", "ultra"];
  document.getElementById('complexity').value = getRandomItem(complexities);
  
  // Options du prompt n√©gatif
  document.getElementById('includeNegativePrompt').checked = Math.random() > 0.3;
  document.getElementById('autoCopyNegative').checked = Math.random() > 0.5;
  document.getElementById('showEnglishNegative').checked = Math.random() > 0.7;
  
  // Mettre √† jour l'affichage de la version anglaise
  document.getElementById('englishNegativeContainer').style.display = 
    document.getElementById('showEnglishNegative').checked ? 'block' : 'none';
  
  // Texte sur l'image
  const texts = ["Bienvenue", "Hello World", "Carpe Diem", "√âv√©nement sp√©cial", "Limited Edition", "2024"];
  document.getElementById('imageText').value = Math.random() > 0.5 ? getRandomItem(texts) : "";
  
  // Style de texte al√©atoire
  const textStyles = document.getElementById('textStyle').options;
  document.getElementById('textStyle').selectedIndex = Math.floor(Math.random() * textStyles.length);
  
  // Couleur al√©atoire
  const textColors = document.getElementById('textColorName').options;
  document.getElementById('textColorName').selectedIndex = Math.floor(Math.random() * (textColors.length - 1)); // Exclure "custom"
  updateColorPicker(document.getElementById('textColorName'));
  
  // Position al√©atoire
  const textPositions = document.getElementById('textPosition').options;
  document.getElementById('textPosition').selectedIndex = Math.floor(Math.random() * textPositions.length);
  
  // Taille al√©atoire
  const textSizes = document.getElementById('textSize').options;
  document.getElementById('textSize').selectedIndex = Math.floor(Math.random() * textSizes.length);
  
  // Options al√©atoires
  document.getElementById('includeTextInPrompt').checked = Math.random() > 0.3;
  document.getElementById('textWithBackground').checked = Math.random() > 0.5;
  document.getElementById('textTransparent').checked = Math.random() > 0.7;
  
  // D√©tails al√©atoires
  const textDetailsOptions = ["avec ombre port√©e", "avec effet 3D", "brillant", "avec contour"];
  document.getElementById('textDetails').value = Math.random() > 0.5 ? getRandomItem(textDetailsOptions) : "";
  
  // Vider les champs personnalis√©s
  document.querySelectorAll('.custom-input').forEach(field => {
    if (field.id !== 'negativePrompt' && field.id !== 'negativePromptEnglish') {
      field.value = '';
      highlightCustomField(field);
    }
  });
  
  showNotification("üé≤ Tous les champs ont √©t√© randomis√©s !", "#9d4edd");
  
  // G√©n√©rer automatiquement
  setTimeout(() => {
    generatePrompt();
  }, 300);
}

function generatePrompt() {
  // Afficher le chargement
  const loading = document.getElementById('loading');
  loading.style.display = 'block';
  
  // V√©rifier si on priorise les champs personnalis√©s
  const prioritizeCustom = document.getElementById('toggleCustom').checked;
  
  // Pr√©paration des √©l√©ments avec priorit√© aux champs personnalis√©s
  let personality, personalitySource;
  const customPersonality = document.getElementById('customPersonality').value.trim();
  
  if (prioritizeCustom && customPersonality) {
    personality = customPersonality;
    personalitySource = "üî§ Personnalit√© personnalis√©e";
  } else if (selectedPersonality) {
    personality = selectedPersonality.name;
    personalitySource = "üé≠ S√©lectionn√©e dans la liste";
  } else if (customPersonality) {
    personality = customPersonality;
    personalitySource = "üî§ Personnalit√© personnalis√©e";
  } else {
    personality = getRandomItem(data.personalities).name;
    personalitySource = "üé≤ Al√©atoire";
  }
  
  // Fonction g√©n√©rique pour obtenir une valeur avec priorit√©
  function getValue(selectId, customId, defaultValue = "") {
    const customValue = document.getElementById(customId).value.trim();
    if (prioritizeCustom && customValue) {
      return customValue;
    }
    const selectValue = document.getElementById(selectId).value;
    if (selectValue) return selectValue;
    if (customValue) return customValue;
    return defaultValue;
  }
  
  // R√©cup√©ration des valeurs avec la logique de priorit√©
  const genre = document.getElementById('genre').value;
  const format = document.getElementById('format').value;
  
  // √Çge : personnalis√© ou s√©lectionn√©
  const customAge = document.getElementById('customAge').value.trim();
  const age = customAge || document.getElementById('age').value;
  
  // Action : personnalis√©e ou s√©lectionn√©e
  const action = getValue('action', 'customAction', getRandomItem(data.actions));
  
  // Lieu : personnalis√© ou s√©lectionn√©
  const lieu = getValue('lieu', 'customLieu', getRandomItem(data.lieux));
  
  // √âpoque : personnalis√©e ou s√©lectionn√©e
  const epoque = getValue('epoque', 'customEpoque', "");
  
  // Compagnon : personnalis√© ou s√©lectionn√©
  const compagnon = getValue('compagnon', 'customCompagnon', "");
  
  // Relation : personnalis√©e ou s√©lectionn√©e
  const relation = getValue('relationType', 'customRelation', "");
  const proximite = document.getElementById('proximite').value;
  
  // Style : personnalis√© ou s√©lectionn√©
  const style = getValue('style', 'customStyle', getRandomItem(data.styles));
  
  // √âclairage : personnalis√© ou s√©lectionn√©
  const eclairage = getValue('eclairage', 'customEclairage', getRandomItem(data.eclairages));
  
  // Costume : personnalis√© ou s√©lectionn√©
  const costume = getValue('costume', 'customCostume', "");
  
  // √âv√©nement : personnalis√© ou s√©lectionn√©
  const evenement = getValue('evenement', 'customEvenement', "");
  
  // D√©tails suppl√©mentaires
  const emotions = document.getElementById('emotions').value;
  const customDetails = document.getElementById('customDetails').value.trim();
  const quality = document.getElementById('quality').value;
  const complexity = document.getElementById('complexity').value;
  
  // Texte sur l'image
  const imageText = getImageTextDescription();
  
  // Modes sp√©ciaux
  const modeHumoristique = document.getElementById('modeHumoristique').checked;
  const modeAnachronique = document.getElementById('modeAnachronique').checked;
  const modeSurrealiste = document.getElementById('modeSurrealiste').checked;
  const modeRandom = document.getElementById('modeRandom').checked;
  const showMarkers = document.getElementById('showCustomMarkers').checked;
  
  // Construction du prompt
  let promptParts = [];
  
  // Format
  promptParts.push(format);
  
  // Lieu et √©poque
  if (epoque) {
    promptParts.push(`${lieu} ${epoque}`);
  } else {
    promptParts.push(lieu);
  }
  
  // Personnalit√© avec d√©tails
  let personalityDesc = `${personality} `;
  if (genre) personalityDesc += `(${genre}) `;
  if (age) personalityDesc += `${age} `;
  if (costume) personalityDesc += `${costume} `;
  
  personalityDesc += action;
  promptParts.push(personalityDesc);
  
  // √âmotions
  if (emotions) {
    promptParts.push(`expression: ${emotions}`);
  }
  
  // Relation et compagnon - NOUVELLE LOGIQUE AM√âLIOR√âE
  if (compagnon) {
    let relationText = "";
    
    // Si une relation sp√©cifique est d√©finie
    if (relation) {
      relationText = `${relation} `;
    } else {
      // Sinon, utiliser "avec" par d√©faut
      relationText = "avec ";
    }
    
    // Ajouter la proximit√© si sp√©cifi√©e
    if (proximite) {
      relationText = `${proximite}, ${relationText}`;
    }
    
    promptParts.push(`${relationText}${compagnon}`);
  }
  
  // √âclairage
  promptParts.push(eclairage);
  
  // Style artistique
  promptParts.push(style);
  
  // √âv√©nement
  if (evenement) {
    promptParts.push(`sc√®ne de ${evenement}`);
  }
  
  // D√©tails personnalis√©s
  if (customDetails) {
    promptParts.push(customDetails);
  }
  
  // Texte sur l'image
  if (imageText) {
    promptParts.push(imageText);
  }
  
  // Qualit√©
  promptParts.push(quality);
  
  // Ajouts selon la complexit√©
  if (complexity === "detaille" || complexity === "ultra") {
    promptParts.push("profondeur de champ ma√Ætris√©e");
    promptParts.push("textures riches");
    promptParts.push("d√©tails fins");
  }
  
  if (complexity === "ultra") {
    promptParts.push("rendu cin√©matographique professionnel");
    promptParts.push("√©clairage studio qualit√© film");
    promptParts.push("composition parfaite");
  }
  
  // Humour si activ√©
  if (modeHumoristique) {
    const humorElements = [
      "avec une touche d'humour absurde",
      "√©l√©ment comique inattendu",
      "situation humoristique d√©cal√©e",
      "expression faciale comique"
    ];
    promptParts.push(getRandomItem(humorElements));
  }
  
  // Anachronisme si activ√©
  if (modeAnachronique) {
    const anachronisms = [
      "anachronisme cr√©atif",
      "m√©lange d'√©poques surr√©aliste",
      "√©l√©ments temporels d√©cal√©s",
      "fusion historique-futuriste"
    ];
    promptParts.push(getRandomItem(anachronisms));
  }
  
  // Surr√©alisme si activ√©
  if (modeSurrealiste) {
    const surrealElements = [
      "touche surr√©aliste",
      "r√©alit√© d√©form√©e",
      "√©l√©ments oniriques",
      "perspective impossible"
    ];
    promptParts.push(getRandomItem(surrealElements));
  }
  
  // Ajout d'√©l√©ments al√©atoires si mode random complet
  if (modeRandom && Math.random() > 0.3) {
    const extraElements = [
      "dynamique mouvement",
      "√©motion intense",
      "composition √©quilibr√©e",
      "cadrage innovant",
      "couleurs vibrantes",
      "contraste saisissant",
      "luminosit√© parfaite"
    ];
    promptParts.push(getRandomItem(extraElements));
  }
  
  // Assemblage final
  let finalPrompt = promptParts.filter(p => p && p.trim() !== '').join(', ');
  
  // Ajout des marqueurs de source si demand√©
  if (showMarkers) {
    const markers = [];
    if (customPersonality) markers.push("PERSO");
    if (document.getElementById('customAction').value.trim()) markers.push("ACTION");
    if (document.getElementById('customLieu').value.trim()) markers.push("LIEU");
    if (customAge) markers.push("√ÇGE");
    if (document.getElementById('customEpoque').value.trim()) markers.push("√âPOQUE");
    if (document.getElementById('customCompagnon').value.trim()) markers.push("COMPAGNON");
    if (relation) markers.push("RELATION");
    if (document.getElementById('customStyle').value.trim()) markers.push("STYLE");
    if (document.getElementById('customEclairage').value.trim()) markers.push("√âCLAIRAGE");
    if (document.getElementById('customCostume').value.trim()) markers.push("COSTUME");
    if (document.getElementById('customEvenement').value.trim()) markers.push("√âV√âNEMENT");
    if (customDetails) markers.push("D√âTAILS");
    if (imageText) markers.push("TEXTE-IMAGE");
    
    if (markers.length > 0) {
      finalPrompt += ` [${markers.join('|')}]`;
    }
  }
  
  // Affichage
  promptCount++;
  document.getElementById('promptCount').textContent = promptCount;
  document.getElementById('counter').textContent = promptCount;
  
  const output = document.getElementById('promptOutput');
  output.value = `#${promptCount} ${finalPrompt}`;
  
  // Mettre √† jour l'indicateur de densit√©
  updateDensityIndicator(finalPrompt);
  
  // Copie automatique
  if (document.getElementById('autoCopy').checked) {
    copyPrompt();
  }
  
  // Mise √† jour des compteurs
  updateCounters();
  
  // Cacher le chargement
  setTimeout(() => {
    loading.style.display = 'none';
    showNotification(`‚úÖ Prompt #${promptCount} g√©n√©r√© !`, '#00ff88');
  }, 500);
}

function copyPrompt() {
  const promptText = document.getElementById('promptOutput').value;
  const cleanText = promptText.replace(/^#\d+\s*/, '');
  
  let textToCopy = cleanText;
  
  // Ajouter le prompt n√©gatif si l'option est coch√©e
  if (document.getElementById('autoCopyNegative').checked) {
    const negativePrompt = getNegativePrompt();
    if (negativePrompt) {
      textToCopy += '\n\n--negative-prompt ' + negativePrompt;
    }
  }
  
  navigator.clipboard.writeText(textToCopy).then(() => {
    // Animation de feedback
    const btn = document.getElementById('copyBtn');
    const originalText = btn.innerHTML;
    btn.innerHTML = '<span>‚úÖ</span> COPI√â !';
    btn.style.background = 'linear-gradient(135deg, #00ff88, #00cc66)';
    
    // Afficher un conseil bas√© sur la densit√©
    let densityAdvice = '';
    const densityInfo = calculatePromptDensity(promptText);
    if (densityInfo.level === 'low') {
      densityAdvice = "üí° Conseil : Votre prompt est assez court. Pensez √† ajouter plus de d√©tails pour de meilleurs r√©sultats !";
    } else if (densityInfo.level === 'very-high') {
      densityAdvice = "üí° Conseil : Votre prompt est tr√®s dense. L'IA pourrait ignorer certains √©l√©ments. Pensez √† simplifier.";
    }
    
    if (densityAdvice) {
      showNotification(densityAdvice, '#00d4ff');
    }
    
    setTimeout(() => {
      btn.innerHTML = originalText;
      btn.style.background = 'linear-gradient(135deg, #4ecdc4, #44a08d)';
    }, 1500);
  });
}

function clearAll() {
  // R√©initialiser les s√©lections
  document.querySelectorAll('.personality-card').forEach(card => {
    card.classList.remove('selected');
  });
  
  // R√©initialiser tous les selects
  document.querySelectorAll('select').forEach(select => {
    select.selectedIndex = 0;
  });
  
  // R√©initialiser tous les inputs texte
  document.querySelectorAll('input[type="text"], textarea').forEach(input => {
    if (input.id !== 'negativePrompt' && input.id !== 'negativePromptEnglish') {
      input.value = '';
    }
    input.classList.remove('custom-active');
  });
  
  // R√©initialiser les checkboxes (sauf autoCopy et toggleCustom)
  document.querySelectorAll('input[type="checkbox"]').forEach(checkbox => {
    if (checkbox.id !== 'autoCopy' && checkbox.id !== 'toggleCustom') {
      checkbox.checked = false;
    }
  });
  
  // R√©activer autoCopy et toggleCustom par d√©faut
  document.getElementById('autoCopy').checked = true;
  document.getElementById('toggleCustom').checked = true;
  
  // R√©initialiser les options du prompt n√©gatif
  document.getElementById('includeNegativePrompt').checked = true;
  document.getElementById('autoCopyNegative').checked = true;
  document.getElementById('showEnglishNegative').checked = false;
  document.getElementById('englishNegativeContainer').style.display = 'none';
  
  // R√©initialiser les options du texte sur l'image
  document.getElementById('imageText').value = "";
  document.getElementById('textStyle').selectedIndex = 0;
  document.getElementById('textColorName').selectedIndex = 0;
  document.getElementById('textColor').value = "#ffffff";
  document.getElementById('colorHex').textContent = "#ffffff";
  document.getElementById('colorHex').style.color = "#ffffff";
  document.getElementById('textPosition').selectedIndex = 0;
  document.getElementById('textSize').selectedIndex = 1; // Moyen par d√©faut
  document.getElementById('includeTextInPrompt').checked = true;
  document.getElementById('textWithBackground').checked = false;
  document.getElementById('textTransparent').checked = false;
  document.getElementById('textDetails').value = "";
  
  selectedPersonality = null;
  
  // Effacer le prompt
  document.getElementById('promptOutput').value = "";
  
  // R√©initialiser l'indicateur de densit√©
  document.getElementById('densityIndicator').style.display = 'none';
  document.getElementById('densityFill').style.width = '0%';
  
  // R√©initialiser les compteurs
  document.getElementById('promptCount').textContent = "0";
  document.getElementById('counter').textContent = "0";
  updateCounters();
  
  showNotification("üßπ Tous les champs ont √©t√© r√©initialis√©s", "#4ecdc4");
}

function generateExample() {
  // Cr√©er un exemple cr√©atif avec des champs personnalis√©s
  document.getElementById('customPersonality').value = "Zarathos, le dernier dragon-mage";
  highlightCustomField(document.getElementById('customPersonality'));
  
  document.getElementById('genre').value = "non-binaire";
  document.getElementById('age').selectedIndex = 3; // Adulte m√ªr
  document.getElementById('format').selectedIndex = 0; // 16:9
  
  document.getElementById('customAction').value = "invoque un portail interdimensionnel";
  highlightCustomField(document.getElementById('customAction'));
  
  document.getElementById('customLieu').value = "au sommet d'une citadelle flottante";
  highlightCustomField(document.getElementById('customLieu'));
  
  document.getElementById('customEpoque').value = "√®re des dragons oubli√©s";
  highlightCustomField(document.getElementById('customEpoque'));
  
  document.getElementById('customCompagnon').value = "des golems de pierre";
  highlightCustomField(document.getElementById('customCompagnon'));
  
  document.getElementById('relationType').value = "prot√©g√© par";
  document.getElementById('proximite').value = "en cercle autour";
  
  document.getElementById('customStyle').value = "peinture √† l'huile baroque, style Frank Frazetta";
  highlightCustomField(document.getElementById('customStyle'));
  
  document.getElementById('customEclairage').value = "√©clairs violets d√©chirant un ciel nocturne";
  highlightCustomField(document.getElementById('customEclairage'));
  
  document.getElementById('customCostume').value = "v√™tu d'une cape tiss√©e d'√©toiles et d'une armure runique";
  highlightCustomField(document.getElementById('customCostume'));
  
  document.getElementById('customEvenement').value = "rituel d'apocalypse";
  highlightCustomField(document.getElementById('customEvenement'));
  
  document.getElementById('emotions').value = "concentration extr√™me";
  document.getElementById('customDetails').value = "Des livres anciens flottent autour de lui, des runes lumineuses grav√©es dans l'air";
  highlightCustomField(document.getElementById('customDetails'));
  
  // Texte sur l'image pour l'exemple
  document.getElementById('imageText').value = "Rituel Interdit";
  document.getElementById('textStyle').value = "en n√©on";
  document.getElementById('textColorName').value = "#ff00ff";
  updateColorPicker(document.getElementById('textColorName'));
  document.getElementById('textPosition').value = "en haut";
  document.getElementById('textSize').value = "grand";
  document.getElementById('includeTextInPrompt').checked = true;
  document.getElementById('textWithBackground').checked = true;
  document.getElementById('textDetails').value = "avec effet de brume";
  
  document.getElementById('quality').selectedIndex = 1; // Ultra-d√©taill√© 8K
  document.getElementById('complexity').value = "ultra";
  
  // Activer les modes cr√©atifs
  document.getElementById('modeAnachronique').checked = true;
  document.getElementById('modeSurrealiste').checked = true;
  document.getElementById('showCustomMarkers').checked = true;
  
  // Activer le prompt n√©gatif
  document.getElementById('includeNegativePrompt').checked = true;
  document.getElementById('autoCopyNegative').checked = true;
  
  // D√©s√©lectionner les personnalit√©s pr√©d√©finies
  document.querySelectorAll('.personality-card').forEach(card => {
    card.classList.remove('selected');
  });
  document.getElementById('personalitySelect').value = "";
  selectedPersonality = null;
  
  updateCounters();
  
  // G√©n√©rer l'exemple
  setTimeout(() => {
    generatePrompt();
    showNotification("‚ú® Exemple cr√©atif charg√© !", "#9d4edd");
  }, 500);
}

// Raccourcis clavier
document.addEventListener('keydown', function(e) {
  // Ctrl + Entr√©e pour g√©n√©rer
  if (e.ctrlKey && e.key === 'Enter') {
    generatePrompt();
  }
  
  // Ctrl + R pour randomiser
  if (e.ctrlKey && e.key === 'r') {
    randomizeAll();
  }
  
  // Ctrl + C pour copier
  if (e.ctrlKey && e.key === 'c') {
    copyPrompt();
  }
  
  // Ctrl + E pour exemple
  if (e.ctrlKey && e.key === 'e') {
    generateExample();
  }
  
  // Ctrl + Suppr pour effacer
  if (e.ctrlKey && e.key === 'Delete') {
    clearAll();
  }
});

// Tooltip pour les raccourcis
window.onload = function() {
  const shortcuts = [
    {key: "Ctrl+Enter", action: "G√©n√©rer un prompt"},
    {key: "Ctrl+R", action: "Randomiser tout"},
    {key: "Ctrl+C", action: "Copier le prompt"},
    {key: "Ctrl+E", action: "Charger un exemple"},
    {key: "Ctrl+Suppr", action: "Tout effacer"}
  ];
  
  const buttonGroup = document.querySelector('.button-group');
  const tooltip = document.createElement('div');
  tooltip.style.cssText = `
    font-size: 0.9em;
    color: #88ccff;
    text-align: center;
    margin-top: 10px;
    opacity: 0.8;
    padding: 10px;
    background: rgba(0, 30, 60, 0.3);
    border-radius: 10px;
  `;
  tooltip.innerHTML = `<strong>Raccourcis clavier :</strong><br>${shortcuts.map(s => `<kbd>${s.key}</kbd> = ${s.action}`).join(' ‚Ä¢ ')}`;
  buttonGroup.parentNode.insertBefore(tooltip, buttonGroup.nextSibling);
  
  // Ajouter des styles pour kbd
  const style = document.createElement('style');
  style.textContent = `
    kbd {
      background: rgba(0, 212, 255, 0.2);
      border: 1px solid rgba(0, 212, 255, 0.5);
      border-radius: 4px;
      padding: 2px 6px;
      font-family: monospace;
      font-size: 0.9em;
    }
    
    @keyframes slideIn {
      from { transform: translateX(100%); opacity: 0; }
      to { transform: translateX(0); opacity: 1; }
    }
    
    @keyframes slideOut {
      from { transform: translateX(0); opacity: 1; }
      to { transform: translateX(100%); opacity: 0; }
    }
  `;
  document.head.appendChild(style);
};
</script>
</body>
</html>
